<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>chombo-discharge: ParticleOps Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">chombo-discharge
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classParticleOps-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ParticleOps Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A shallow static class for doing various kinds of particle-related operations.  
 <a href="classParticleOps.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CD__ParticleOps_8H_source.html">CD_ParticleOps.H</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:afc924720c8332e493951fec08881ef3d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classParticleOps.html#afc924720c8332e493951fec08881ef3d">domainIntersection</a> (const RealVect &amp;a_oldPos, const RealVect &amp;a_newPos, const RealVect &amp;a_probLo, const RealVect &amp;a_probHi, Real &amp;a_s)</td></tr>
<tr class="memdesc:afc924720c8332e493951fec08881ef3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the intersection point between a particle path and a domain side.  <a href="classParticleOps.html#afc924720c8332e493951fec08881ef3d">More...</a><br /></td></tr>
<tr class="separator:afc924720c8332e493951fec08881ef3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2914cd2dc872d5ec05a7d250a677ff"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classParticleOps.html#a4f2914cd2dc872d5ec05a7d250a677ff">ebIntersectionBisect</a> (const RefCountedPtr&lt; BaseIF &gt; &amp;a_impFunc, const RealVect &amp;a_oldPos, const RealVect &amp;a_newPos, const Real &amp;a_bisectStep, Real &amp;a_s)</td></tr>
<tr class="memdesc:a4f2914cd2dc872d5ec05a7d250a677ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the intersection point between a particle path and an implicit function using a bisection algorithm.  <a href="classParticleOps.html#a4f2914cd2dc872d5ec05a7d250a677ff">More...</a><br /></td></tr>
<tr class="separator:a4f2914cd2dc872d5ec05a7d250a677ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e95a39f57c9272a20ef9411efdff221"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classParticleOps.html#a3e95a39f57c9272a20ef9411efdff221">ebIntersectionRaycast</a> (const RefCountedPtr&lt; BaseIF &gt; &amp;a_impFunc, const RealVect &amp;a_oldPos, const RealVect &amp;a_newPos, const Real &amp;a_tolerance, Real &amp;a_s)</td></tr>
<tr class="memdesc:a3e95a39f57c9272a20ef9411efdff221"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the intersection point between a particle path and an implicit function using a ray-casting algorithm.  <a href="classParticleOps.html#a3e95a39f57c9272a20ef9411efdff221">More...</a><br /></td></tr>
<tr class="separator:a3e95a39f57c9272a20ef9411efdff221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc943102825613566a32f8b31d90398"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classParticleOps.html#a3cc943102825613566a32f8b31d90398">computeParticleWeights</a> (unsigned long long &amp;a_weight, unsigned long long &amp;a_num, unsigned long long &amp;a_remainder, const unsigned long long a_numPhysicalParticles, const int a_ppc)</td></tr>
<tr class="memdesc:a3cc943102825613566a32f8b31d90398"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute particle weights.  <a href="classParticleOps.html#a3cc943102825613566a32f8b31d90398">More...</a><br /></td></tr>
<tr class="separator:a3cc943102825613566a32f8b31d90398"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A shallow static class for doing various kinds of particle-related operations. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a3cc943102825613566a32f8b31d90398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc943102825613566a32f8b31d90398">&#9670;&nbsp;</a></span>computeParticleWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ParticleOps::computeParticleWeights </td>
          <td>(</td>
          <td class="paramtype">unsigned long long &amp;&#160;</td>
          <td class="paramname"><em>a_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long &amp;&#160;</td>
          <td class="paramname"><em>a_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long &amp;&#160;</td>
          <td class="paramname"><em>a_remainder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long long&#160;</td>
          <td class="paramname"><em>a_numPhysicalParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>a_ppc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute particle weights. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">a_weight</td><td>Particle weights for "whole" computational particles. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_num</td><td>Number of "whole" computational particles </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_remainder</td><td>Weight remainder </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_numPhysicalParticles</td><td>Number of physical particles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_ppc</td><td>Desired number of computational particles</td></tr>
  </table>
  </dd>
</dl>
<p>This takes a specified number of physical particles and "desired" number of computational particles and computes the number of "whole" computational particles and a remainder. So, if we have 10 physical particles but want 3 computational particles we have a_weight = 3, a_num=3, and a_remainder = 1 </p>

</div>
</div>
<a id="afc924720c8332e493951fec08881ef3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc924720c8332e493951fec08881ef3d">&#9670;&nbsp;</a></span>domainIntersection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ParticleOps::domainIntersection </td>
          <td>(</td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_oldPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_newPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_probLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_probHi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real &amp;&#160;</td>
          <td class="paramname"><em>a_s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the intersection point between a particle path and a domain side. </p>
<p>If the particle crossed the domain side, the output argument a_s determines the intersection point by x(s) = x0 + s*(x1-x0) where x0 is the starting position (a_oldPos), x1 is the end position (a_newPos), and x(s) is the intersection point with the boundary. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a_oldPos</td><td>Particle starting position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_newPos</td><td>Particle end position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_probLo</td><td>Lower-left corner in physical coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_probHi</td><td>Upper-right corner in physical coordinates </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_s</td><td>Relative length along the path </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the particle crossed the domain boundary. </dd></dl>

</div>
</div>
<a id="a4f2914cd2dc872d5ec05a7d250a677ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2914cd2dc872d5ec05a7d250a677ff">&#9670;&nbsp;</a></span>ebIntersectionBisect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ParticleOps::ebIntersectionBisect </td>
          <td>(</td>
          <td class="paramtype">const RefCountedPtr&lt; BaseIF &gt; &amp;&#160;</td>
          <td class="paramname"><em>a_impFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_oldPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_newPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real &amp;&#160;</td>
          <td class="paramname"><em>a_bisectStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real &amp;&#160;</td>
          <td class="paramname"><em>a_s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the intersection point between a particle path and an implicit function using a bisection algorithm. </p>
<p>This routine will bisect the particle path into intervals of length a_bisectStep. Each interval is examined for a crossing with the implicit function and if the particle crossed the into the EB, the output argument a_s determines the intersection point by x(s) = x0 + s*(x1-x0) where x0 is the starting position (a_oldPos), x1 is the end position (a_newPos), and x(s) is the intersection point with the geometry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a_impFunc</td><td>Implicit function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_oldPos</td><td>Particle starting position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_newPos</td><td>Particle end position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_bisectStep</td><td>Bisection step length </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_s</td><td>Relative length along the path </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the particle crossed into the EB. </dd></dl>

</div>
</div>
<a id="a3e95a39f57c9272a20ef9411efdff221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e95a39f57c9272a20ef9411efdff221">&#9670;&nbsp;</a></span>ebIntersectionRaycast()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ParticleOps::ebIntersectionRaycast </td>
          <td>(</td>
          <td class="paramtype">const RefCountedPtr&lt; BaseIF &gt; &amp;&#160;</td>
          <td class="paramname"><em>a_impFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_oldPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RealVect &amp;&#160;</td>
          <td class="paramname"><em>a_newPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real &amp;&#160;</td>
          <td class="paramname"><em>a_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real &amp;&#160;</td>
          <td class="paramname"><em>a_s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the intersection point between a particle path and an implicit function using a ray-casting algorithm. </p>
<p>This routine will assume that a_impcFunc is an approximation to the signed distance function and compute the intersection point using ray-marching. Starting on the starting position we compute the distance to the EB and move the particle the compute distance along the particle trajectory. If the particle comes too close to the EB (within a_tolerance) we consider it to be absorbed. In that case the output argument a_s determines the intersection point by x(s) = x0 + s*(x1-x0) where x0 is the starting position (a_oldPos), x1 is the end position (a_newPos), and x(s) is the intersection point with the geometry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a_impFunc</td><td>Implicit function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_oldPos</td><td>Particle starting position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_newPos</td><td>Particle end position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a_tolerace</td><td>Tolerance for intersectinon method. If the distance to the EB is less than this, the particle is absorbed. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a_s</td><td>Relative length along the path </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the particle crossed into the EB. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Source/Particle/<a class="el" href="CD__ParticleOps_8H_source.html">CD_ParticleOps.H</a></li>
<li>Source/Particle/<a class="el" href="CD__ParticleOpsImplem_8H_source.html">CD_ParticleOpsImplem.H</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
