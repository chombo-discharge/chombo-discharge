<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Controlling chombo-discharge &mdash; chombo-discharge  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="Examples.html" />
    <link rel="prev" title="Installation" href="Installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chombo-discharge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-chombo-discharge">Running <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#serial">Serial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-with-openmp">Parallel with OpenMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-with-mpi">Parallel with MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-with-mpi-openmp">Parallel with MPI+OpenMP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-i-o">Simulation I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simulation-inputs">Simulation inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simulation-outputs">Simulation outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-processor-verbosity">Parallel processor verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restarting-simulations">Restarting simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-time-configurations">Run-time configurations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing.html">Code testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/DesignOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ComputationalGeometry.html">ComputationalGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/TimeStepper.html">TimeStepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/AmrMesh.html">AmrMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/CellTagger.html">CellTagger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/GeoCoarsener.html">GeoCoarsener</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/SpatialDiscretization.html">Spatial discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ChomboBasics.html"><code class="docutils literal notranslate"><span class="pre">Chombo-3</span></code> basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/MeshData.html">Mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/LinearSolvers.html">Linear solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/VV.html">Verification and validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Electrostatics.html">Electrostatic solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/KineticMonteCarlo.html">Kinetic Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/MeshODESolver.html">Mesh ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/SurfaceODESolver.html">Surface ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/TracerParticles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Ito.html">Îto diffusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-physics applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/CdrPlasmaModel.html">CDR plasma model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/StreamerInceptionModel.html">Streamer inception model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ItoKMC.html">Îto-KMC plasma model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Single-solver applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/AdvectionDiffusionModel.html">Advection-diffusion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/BrownianWalkerModel.html">Brownian walker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ElectrostaticsModel.html">Electrostatics model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/GeometryModel.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/MeshODEModel.html">Mesh ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/RadiativeTransferModel.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/TracerParticleModel.html">Tracer particle model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/DataParser.html">Data parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LookupTable.html">Lookup tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/RandomNumbers.html">Random numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LeastSquares.html">Least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/Contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/CodeStandard.html">Code standard</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZZReferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chombo-discharge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Base/Control.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="controlling-chombo-discharge">
<span id="chap-control"></span><h1>Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code><a class="headerlink" href="#controlling-chombo-discharge" title="Permalink to this heading"></a></h1>
<p>In this chapter we give a brief overview of how to run a <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> simulation and control its behavior through input scripts or command line options.</p>
<section id="running-chombo-discharge">
<h2>Running <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code><a class="headerlink" href="#running-chombo-discharge" title="Permalink to this heading"></a></h2>
<p>How one runs <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> depends on the type of parallelism one compiled with.
Below, we consider basic examples for serial and parallel execution.</p>
<section id="serial">
<h3>Serial<a class="headerlink" href="#serial" title="Permalink to this heading"></a></h3>
<p>If the application was compiled for serial execution one runs it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./&lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
<p>where &lt;input_file&gt; is your input file.</p>
</section>
<section id="parallel-with-openmp">
<h3>Parallel with OpenMP<a class="headerlink" href="#parallel-with-openmp" title="Permalink to this heading"></a></h3>
<p>When running with OpenMP one must specify the number of threads, and possibly also the binding of threads.
<code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> is compiled with run-time thread scheduling (which defaults to static), which can be specified.
For example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">8</span>
<span class="nb">export</span> <span class="nv">OMP_PLACES</span><span class="o">=</span>cores
<span class="nb">export</span> <span class="nv">OMP_PROC_BIND</span><span class="o">=</span><span class="nb">true</span>
<span class="nb">export</span> <span class="nv">OMP_SCHEDULE</span><span class="o">=</span><span class="s2">&quot;dynamic, 4&quot;</span>

./&lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
</section>
<section id="parallel-with-mpi">
<h3>Parallel with MPI<a class="headerlink" href="#parallel-with-mpi" title="Permalink to this heading"></a></h3>
<p>If the executable was compiled with MPI, one executes with e.g. <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> (or one of its aliases):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">8</span> &lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
<p>On clusters, this is a little bit different and usually requires passing the above command through a batch system.
Normally, the MPI installation will map processes to cores.
With OpenMP one can use <code class="docutils literal notranslate"><span class="pre">--report-bindings</span></code> to verify the mapping.</p>
</section>
<section id="parallel-with-mpi-openmp">
<h3>Parallel with MPI+OpenMP<a class="headerlink" href="#parallel-with-mpi-openmp" title="Permalink to this heading"></a></h3>
<p>When running with both MPI and OpenMP the user must</p>
<ol class="arabic simple">
<li><p>Bind each MPI rank to a specified resource (e.g., a node, socket, or list of CPUs)</p></li>
<li><p>Bind OpenMP threads to resources available to each MPI rank.</p></li>
</ol>
<p>For example, the following may not work as expected:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>
mpiexec -n <span class="m">2</span> ./&lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
<p>Each MPI rank may spawn threads on the same physical cores.
With e.g. OpenMPI one can map each rank to a specified number of CPUs, and bind threads to those CPUs.
For example, on a local workstation one might do</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">NRANKS</span><span class="o">=</span><span class="m">2</span>
<span class="nb">export</span> <span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>
<span class="nb">export</span> <span class="nv">OMP_PLACES</span><span class="o">=</span>cores
<span class="nb">export</span> <span class="nv">OMP_PROC_BIND</span><span class="o">=</span><span class="nb">true</span>

mpiexec --bind-to core --map-by slot:PE<span class="o">=</span><span class="nv">$OMP_NUM_THREADS</span> -n <span class="nv">$NRANKS</span> ./&lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
<p>MPI bindings are here bound to cores and will spawn threads only on the cores they are associated with.
It is often useful to verify this by reporting the bindings as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec --report-bindings --bind-to core --map-by slot:PE<span class="o">=</span><span class="nv">$OMP_NUM_THREADS</span> -n <span class="nv">$NRANKS</span> ./&lt;application_executable&gt; &lt;input_file&gt;
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>More sophisticated architectures (e.g., clusters with NUMA nodes) require careful specification of MPI and thread placement (e.g. binding of MPI ranks to sockets).</p>
</div>
</section>
</section>
<section id="simulation-i-o">
<h2>Simulation I/O<a class="headerlink" href="#simulation-i-o" title="Permalink to this heading"></a></h2>
<section id="simulation-inputs">
<h3>Simulation inputs<a class="headerlink" href="#simulation-inputs" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> simulations take their input from a single simulation input file (possibly appended with overriding options on the command line).
Simulations may consist of several hundred possible switches for altering the behavior of a simulation, and all physics models in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> are therefore equipped with Python setup tools that collect all such options into a single file when setting up a new application.
Generally, these input parameters are fetched from the options file of component that is used in a simulation.
Simulation options usually consist of a prefix, a suffix, and a configuration value.
For example, the configuration options that adjusts the number of time steps that will be run in a simulation is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Driver.max_steps = 100
</pre></div>
</div>
<p>Likewise, for controlling how often plot are written:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Driver.plot_interval = 5
</pre></div>
</div>
<p>You may also pass input parameters through the command line. For example, running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">32</span> &lt;application_executable&gt; &lt;input_file&gt; Driver.max_steps<span class="o">=</span><span class="m">10</span>
</pre></div>
</div>
<p>will set the <code class="docutils literal notranslate"><span class="pre">Driver.max_steps</span></code> parameter to 10.
Command-line parameters override definitions in the input file.
Moreover, parameters parsed through the command line become static parameters, i.e. they are not run-time configurable (see <a class="reference internal" href="#chap-runtimeconfig"><span class="std std-ref">Run-time configurations</span></a>).
Also note that if you define a parameter multiple times in the input file, the last definition is canon.</p>
</section>
<section id="simulation-outputs">
<h3>Simulation outputs<a class="headerlink" href="#simulation-outputs" title="Permalink to this heading"></a></h3>
<p>Mesh data from <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> simulations is by default written to HDF5 files, and if HDF5 is disabled <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> will not write any plot or checkpoint files.
In addition to plot files, MPI ranks can output information to separate files so that the simulation progress can be tracked.</p>
<p><code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> comes with controls for adjusting output.
Through the <a class="reference internal" href="../Source/Driver.html#chap-driver"><span class="std std-ref">Driver</span></a> class the user may adjust the option <code class="docutils literal notranslate"><span class="pre">Driver.output_directory</span></code> to specify where output files will be placed.
This directory is relative to the location where the application is run.
If this directory does not exist, <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> will create it.
It will also create the following subdirectories given in <a class="reference internal" href="#tab-outputdirectories"><span class="std std-ref">Simulation output organization.</span></a>.</p>
<span id="tab-outputdirectories"></span><table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Simulation output organization.</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Folder</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="file docutils literal notranslate"><span class="pre">chk</span></code></p></td>
<td><p>Checkpoint files (these are used for restarting simulations from a specified time step).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="file docutils literal notranslate"><span class="pre">crash</span></code></p></td>
<td><p>Plot files written if a simulation crashes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="file docutils literal notranslate"><span class="pre">geo</span></code></p></td>
<td><p>Plot files for geometries (if you run with <code class="docutils literal notranslate"><span class="pre">Driver.geometry_only</span> <span class="pre">=</span> <span class="pre">true</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="file docutils literal notranslate"><span class="pre">mpi</span></code></p></td>
<td><p>Information about individual MPI ranks, such as computational loads or memory consumption per rank.</p></td>
</tr>
<tr class="row-even"><td><p><code class="file docutils literal notranslate"><span class="pre">plt</span></code></p></td>
<td><p>All plot files.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="file docutils literal notranslate"><span class="pre">regrid</span></code></p></td>
<td><p>Plot files written during regrids (if you run with <code class="docutils literal notranslate"><span class="pre">Driver.write_regrid_files</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="file docutils literal notranslate"><span class="pre">restart</span></code></p></td>
<td><p>Plot files written during restarts (if you run with <code class="docutils literal notranslate"><span class="pre">Driver.write_regrid_files</span></code>).</p></td>
</tr>
</tbody>
</table>
<p>The reason for the output folder structure is that <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> can end up writing thousands of files per simulation and we feel that having a directory structure helps us navigate simulation data.</p>
<p>Fundamentally, there are only two types of HDF5 files written:</p>
<ol class="arabic simple">
<li><p>Plot files, containing plots of simulation data.</p></li>
<li><p>Checkpoint files, which are binary files used for restarting a simulation from a given time step.</p></li>
</ol>
<p>The <a class="reference internal" href="../Source/Driver.html#chap-driver"><span class="std std-ref">Driver</span></a> class is responsible for writing output files at specified intervals, but the user is generally speaking responsible for specifying what goes into the plot files.
Since not all variables are always of interest, solver classes have options like <code class="docutils literal notranslate"><span class="pre">plt_vars</span></code> that specify which output variables in the solver will be written to the output file.
For example, one of our convection-diffusion-reaction solver classes have the following output options:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>CdrGodunov.plt_vars = phi vel dco src ebflux # Plot variables. Options are &#39;phi&#39;, &#39;vel&#39;, &#39;dco&#39;, &#39;src&#39;, &#39;ebflux&#39;
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">phi</span></code> is the state density, <code class="docutils literal notranslate"><span class="pre">vel</span></code> is the drift velocity, <code class="docutils literal notranslate"><span class="pre">dco</span></code> is the diffusion coefficient, <code class="docutils literal notranslate"><span class="pre">src</span></code> is the source term, and <code class="docutils literal notranslate"><span class="pre">ebflux</span></code> is the flux at embedded boundaries.
If you only want to plot the density, then you should put <code class="docutils literal notranslate"><span class="pre">CdrGodunov.plt_vars</span> <span class="pre">=</span> <span class="pre">phi</span></code>.
An empty entry like <code class="docutils literal notranslate"><span class="pre">CdrGodunov.plt_vars</span> <span class="pre">=</span></code> may lead to run-time errors, so if you do not want a class to provide plot data you may put <code class="docutils literal notranslate"><span class="pre">CdrGodunov.plt_vars</span> <span class="pre">=</span> <span class="pre">none</span></code>.</p>
</section>
<section id="parallel-processor-verbosity">
<span id="chap-pout"></span><h3>Parallel processor verbosity<a class="headerlink" href="#parallel-processor-verbosity" title="Permalink to this heading"></a></h3>
<p>By default, <code class="docutils literal notranslate"><span class="pre">Chombo</span></code> will write a process output file <em>per MPI process</em> and this file will be named <code class="file docutils literal notranslate"><span class="pre">pout.n</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the MPI rank.
These files are written in the directory where you executed your application, and are <em>not</em> related to plot files or checkpoint files.
However, <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> prints information to these files as simulations advance (for example by displaying information of the current time step, or convergence rates for multigrid solvers).
To see information regarding the latest time steps, simply print a few lines in these files, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tail -200 pout.0
</pre></div>
</div>
<p>While it is possible to monitor the evolution of <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> for each MPI rank, most of these files contain redundant information.
To adjust the number of files that will be written, <code class="docutils literal notranslate"><span class="pre">Chombo</span></code> can read an environment variable <code class="docutils literal notranslate"><span class="pre">CH_OUTPUT_INTERVAL</span></code> that determines which MPI ranks write <code class="file docutils literal notranslate"><span class="pre">pout.n</span></code> files.
For example, if you only want the master MPI rank to write <code class="file docutils literal notranslate"><span class="pre">pout.0</span></code>, you would do</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CH_OUTPUT_INTERVAL</span><span class="o">=</span><span class="m">999999999</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you run simulations at high concurrencies, you <em>should</em> turn off the number of process output files since they impact the performance of the file system.</p>
</div>
</section>
<section id="restarting-simulations">
<span id="chap-restartingsimulations"></span><h3>Restarting simulations<a class="headerlink" href="#restarting-simulations" title="Permalink to this heading"></a></h3>
<p>Restarting simulations is done in exactly the same way as running simulations, although the user must set the <code class="docutils literal notranslate"><span class="pre">Driver.restart</span></code> parameter.
For example,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">32</span> &lt;application_executable&gt; &lt;input_file&gt; Driver.restart<span class="o">=</span><span class="m">10</span>
</pre></div>
</div>
<p>will restart from step 10.</p>
<p>Specifying anything but an integer is an error.
When a simulation is restarted, <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> will look for a checkpoint file with the <code class="docutils literal notranslate"><span class="pre">Driver.output_names</span></code> variable and the specified restart step.
It will look for this file in the subfolder <code class="file docutils literal notranslate"><span class="pre">/chk</span></code> relative to the execution directory.</p>
<p>If the restart file is not found, restarting will not work and <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> will abort.
You must therefore ensure that your executable can locate this file.
This also implies that you cannot change the <code class="docutils literal notranslate"><span class="pre">Driver.output_names</span></code> or <code class="docutils literal notranslate"><span class="pre">Driver.output_directory</span></code> variables during restarts, unless you also change the name of your checkpoint file and move it to a new directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you set <code class="docutils literal notranslate"><span class="pre">Driver.restart=0</span></code>, you will get a fresh simulation.</p>
</div>
</section>
<section id="run-time-configurations">
<span id="chap-runtimeconfig"></span><h3>Run-time configurations<a class="headerlink" href="#run-time-configurations" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> reads input parameters before the simulation starts, but also during run-time.
This is useful when your simulation waited 5 days in the queue on a cluster before starting, but you forgot to tweak one parameter and don’t want to wait another 5 days.</p>
<p><code class="docutils literal notranslate"><span class="pre">Driver</span></code> re-reads the simulation input parameters after every time step.
The new options are parsed by the core classes <code class="docutils literal notranslate"><span class="pre">Driver</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeStepper</span></code>, <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code>, and <code class="docutils literal notranslate"><span class="pre">CellTagger</span></code> through special routines <code class="docutils literal notranslate"><span class="pre">parseRuntimeOptions()</span></code>.
Note that not all input configurations are suitable for run-time configuration.
For example, increasing the size of the simulation domain does not make sense but changing the blocking factor, refinement criteria, or plot intervals do.
To see which options are run-time configurable, see <a class="reference internal" href="../Source/Driver.html#chap-driver"><span class="std std-ref">Driver</span></a>, <a class="reference internal" href="../Source/AmrMesh.html#chap-amrmesh"><span class="std std-ref">AmrMesh</span></a>, or the <a class="reference internal" href="../Source/TimeStepper.html#chap-timestepper"><span class="std std-ref">TimeStepper</span></a> and <a class="reference internal" href="../Source/CellTagger.html#chap-celltagger"><span class="std std-ref">CellTagger</span></a> that you use.</p>
</section>
</section>
<section id="visualization">
<span id="chap-visualization"></span><h2>Visualization<a class="headerlink" href="#visualization" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> output files are always written to HDF5.
The plot files will reside in the <code class="docutils literal notranslate"><span class="pre">plt</span></code> subfolder where the application was run.</p>
<p>Currently, we have only used <a class="reference external" href="https://visit-dav.github.io/visit-website/">VisIt</a> for visualizing the plot files.
Learning how to use VisIt is not a part of this documentation; there are great tutorials on the <a class="reference external" href="https://visit-dav.github.io/visit-website/">VisIt website</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SINTEF Energy Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>