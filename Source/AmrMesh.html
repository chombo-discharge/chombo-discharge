<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AmrMesh &mdash; chombo-discharge  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CellTagger" href="CellTagger.html" />
    <link rel="prev" title="TimeStepper" href="TimeStepper.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chombo-discharge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Base/Documentation.html">Using this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Control.html">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Testing.html">Code testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DesignOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="ComputationalGeometry.html">ComputationalGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeStepper.html">TimeStepper</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">AmrMesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#class-options">Class options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coarse-grid-decomposition">Coarse-grid decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain-decomposition">Domain decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ghost-cells">Ghost cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multigrid-interpolation">Multigrid interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interpolation-near-the-eb">Interpolation near the EB</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CellTagger.html">CellTagger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="SpatialDiscretization.html">Spatial discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChomboBasics.html"><code class="docutils literal notranslate"><span class="pre">Chombo-3</span></code> basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MeshData.html">Mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="LinearSolvers.html">Linear solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="VV.html">Verification and validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Electrostatics.html">Electrostatic solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Ito.html">Îto diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/KineticMonteCarlo.html">Kinetic Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/MeshODESolver.html">Mesh ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/SurfaceODESolver.html">Surface ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/TracerParticles.html">Tracer particles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-physics applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/CdrPlasmaModel.html">CDR plasma model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/DischargeInceptionModel.html">Discharge inception model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ItoKMC.html">Îto-KMC plasma model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Single-solver applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/AdvectionDiffusionModel.html">Advection-diffusion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/BrownianWalkerModel.html">Brownian walker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ElectrostaticsModel.html">Electrostatics model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/GeometryModel.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/MeshODEModel.html">Mesh ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/RadiativeTransferModel.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/TracerParticleModel.html">Tracer particle model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/DataParser.html">Data parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LookupTable.html">LookupTable1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/RandomNumbers.html">Random numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LeastSquares.html">Least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/Contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/CodeStandard.html">Code standard</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZZReferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chombo-discharge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">AmrMesh</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Source/AmrMesh.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="amrmesh">
<span id="chap-amrmesh"></span><h1>AmrMesh<a class="headerlink" href="#amrmesh" title="Permalink to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> handles virtually the entire AMR and cut-cell infrastructure in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code>, and has the following responsibility:</p>
<ol class="arabic simple">
<li><p>Generate grids form a set of cell tags (potentially more than one set of grids).</p></li>
<li><p>Load balance the grids if necessary.</p></li>
<li><p>Instantiate the cut-cell information on grids.</p></li>
<li><p>Provide a mask which tells the user if a cell is covered by a finer grid.</p></li>
<li><p>Generate operators that are required for handling AMR data, e.g.,</p>
<ul class="simple">
<li><p>Ghost cell interpolators.</p></li>
<li><p>Coarsening operators.</p></li>
<li><p>Stencils for interpolation and extrapolation near the embedded boundaries.</p></li>
<li><p>Fine-to-coarse grid interpolators.</p></li>
<li><p>Infrastructure for particle-mesh operators.</p></li>
<li><p>… and many others.</p></li>
</ul>
</li>
</ol>
<p>In addition to these, <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> contains function for actually allocating data with user-defined centering (e.g., cell, face, EB) on a specified <a class="reference internal" href="Realm.html#chap-realm"><span class="std std-ref">Realm</span></a>.
It also has responsibility for allocating particle containers.</p>
<p>One thing that <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> is <em>not</em>, is a numerical discretization holder for PDEs, which is a responsibility that is generally deferred to solvers.
In some cases <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> certainly holds operators that have an underlying discretization, e.g., gradient operators which have a specific discretization based on least squares reconstruction around the embedded boundaries.
But in virtually all cases one should simply think of these operators as AMR operators that handle specific types of common data operations on mesh and particle data.</p>
<p><code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> is an integral part of <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code>, and users will never have the need to modify it unless they are implementing something entirely new.
The behavior of <a class="reference internal" href="#chap-amrmesh"><span class="std std-ref">AmrMesh</span></a> is modified through its available input parameters.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Here is the <a class="reference external" href="https://chombo-discharge.github.io/chombo-discharge/doxygen/html/classAmrMesh.html">AmrMesh C++ API</a></p>
</div>
<section id="class-options">
<h2>Class options<a class="headerlink" href="#class-options" title="Permalink to this heading"></a></h2>
<p>Various class options are available for adjusting the behavior of the <code class="docutils literal notranslate"><span class="pre">Driver</span></code> class.
Below, we include the current template options file for the <code class="docutils literal notranslate"><span class="pre">Driver</span></code> class.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 21 </span><span class="caption-text">Template input options for the <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> class. Runtime adjustable options are highlighted.</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ====================================================================================================</span>
<span class="c1"># AmrMesh class options</span>
<span class="c1"># ====================================================================================================</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">lo_corner</span>            <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span>       <span class="c1">## Low corner of problem domain</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">hi_corner</span>            <span class="o">=</span> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>        <span class="c1">## High corner of problem domain</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">verbosity</span>            <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>             <span class="c1">## Controls verbosity.</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">coarsest_domain</span>      <span class="o">=</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>    <span class="c1">## Number of cells on coarsest domain</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">max_amr_depth</span>        <span class="o">=</span> <span class="mi">0</span>              <span class="c1">## Maximum amr depth</span>
<span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">max_sim_depth</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>             <span class="c1">## Maximum simulation depth</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">fill_ratio</span>           <span class="o">=</span> <span class="mf">1.0</span>            <span class="c1">## Fill ratio for grid generation</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">buffer_size</span>          <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Number of cells between grid levels</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">grid_algorithm</span>       <span class="o">=</span> <span class="n">tiled</span>          <span class="c1">## Berger-Rigoustous &#39;br&#39; or &#39;tiled&#39; for the tiled algorithm</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">box_sorting</span>          <span class="o">=</span> <span class="n">morton</span>         <span class="c1">## &#39;none&#39;, &#39;shuffle&#39;, &#39;morton&#39;</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">blocking_factor</span>      <span class="o">=</span> <span class="mi">16</span>             <span class="c1">## Blocking factor.</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">max_box_size</span>         <span class="o">=</span> <span class="mi">16</span>             <span class="c1">## Maximum allowed box size</span>
</span><span class="n">AmrMesh</span><span class="o">.</span><span class="n">max_ebis_box</span>         <span class="o">=</span> <span class="mi">16</span>             <span class="c1">## Maximum allowed box size for EBIS generation.</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">ref_rat</span>              <span class="o">=</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span>    <span class="c1">## Refinement ratios (mixed ratios are allowed).</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">num_ghost</span>            <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Number of ghost cells.</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">lsf_ghost</span>            <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Number of ghost cells when writing level-set to grid</span>
<span class="n">AmrMesh</span><span class="o">.</span><span class="n">eb_ghost</span>             <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Set number of of ghost cells for EB stuff</span>
<span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">mg_interp_order</span>      <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Multigrid interpolation order</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">mg_interp_radius</span>     <span class="o">=</span> <span class="mi">2</span>              <span class="c1">## Multigrid interpolation radius</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">mg_interp_weight</span>     <span class="o">=</span> <span class="mi">1</span>              <span class="c1">## Multigrid interpolation weight (for least squares)</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">centroid_interp</span>      <span class="o">=</span> <span class="n">minmod</span>         <span class="c1">## Centroid interp stencils. linear, lsq, minmod, etc</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">eb_interp</span>            <span class="o">=</span> <span class="n">minmod</span>         <span class="c1">## EB interp stencils. linear, taylor, minmod, etc</span>
</span><span class="hll"><span class="n">AmrMesh</span><span class="o">.</span><span class="n">redist_radius</span>        <span class="o">=</span> <span class="mi">1</span>              <span class="c1">## Redistribution radius for hyperbolic conservation laws</span>
</span></pre></div>
</div>
</div>
<p>For users, modifying the behavior of <code class="docutils literal notranslate"><span class="pre">AmrMesh</span></code> is comparatively easy.
We have listed the most commonly adjusted grid parameters above, which include the specification of the physical domain, the maximum number of AMR levels that are permitted, as well as how grids are generated.</p>
</section>
<section id="coarse-grid-decomposition">
<h2>Coarse-grid decomposition<a class="headerlink" href="#coarse-grid-decomposition" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">AmrMesh.lo_corner</span></code> and <code class="docutils literal notranslate"><span class="pre">AmrMesh.hi_corner</span></code> are the physical corners of the simulation domain.
<code class="docutils literal notranslate"><span class="pre">AmrMesh.coarsest_domain</span></code> is the number of grid cells on the coarsest grid level (i.e., without AMR).
It is important that cell sizes are uniform, so one must always have <span class="math notranslate nohighlight">\(\Delta x = \Delta y = \Delta z\)</span>.
Usually, this means that <code class="docutils literal notranslate"><span class="pre">AmrMesh.lo_corner</span></code>, <code class="docutils literal notranslate"><span class="pre">AmrMesh.hi_corner</span></code>, and <code class="docutils literal notranslate"><span class="pre">AmrMesh.coarsest_domain</span></code> must all be consistently defined. Moreover, it is normally desirable to make <code class="docutils literal notranslate"><span class="pre">AmrMesh.coarsest_domain</span></code> a factor of 2 (e.g., 64, 128, 256, etc.), since this permits arbitrarily deep multigrid coarsening.
This is not a requirement, however, although we do note that <code class="docutils literal notranslate"><span class="pre">AmrMesh.coarsest_domain</span></code> <em>must</em> be divisible by <code class="docutils literal notranslate"><span class="pre">AmrMesh.blocking_factor</span></code>.</p>
</section>
<section id="domain-decomposition">
<h2>Domain decomposition<a class="headerlink" href="#domain-decomposition" title="Permalink to this heading"></a></h2>
<p>With Cartesian AMR, each grid level is decomposed into grid blocks of constant size, or sizes that potentially vary between some min/max size along each dimension.
In <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> this is encapsulated by <code class="docutils literal notranslate"><span class="pre">AmrMesh.blocking_factor</span></code>, which is the smallest grid box that can be generated when meshing the domain.
Likewise, <code class="docutils literal notranslate"><span class="pre">AmrMesh.max_box_size</span></code> is the maximum box size that can be produced, but usage of a constant box size is common an increased requirement in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use fixed box sizes where <code class="docutils literal notranslate"><span class="pre">AmrMesh.blocking_factor</span></code> and <code class="docutils literal notranslate"><span class="pre">AmrMesh.max_box_size</span></code> are the same.</p>
</div>
<p>The flag <code class="docutils literal notranslate"><span class="pre">AmrMesh.max_ebis_box</span></code> indicates essentially the blocking factor when generating the cut-cell information at the start of a simulation.
It may happen for very large simulations that one has to increase the box size (e.g., to 32) in order to trim grid metadata.</p>
<p><code class="docutils literal notranslate"><span class="pre">AmrMesh.ref_rat</span></code> determines the refinement ratio between grid levels, and factors of 2 and 4 are supported.
We want to point out that mixed refinement factors are supported.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">AmrMesh.max_amr_depth</span></code> is greater than the number of refinement ratios specified in <code class="docutils literal notranslate"><span class="pre">AmrMesh.ref_rat</span></code>, <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> will automatically fill in the remaining refinement ratios (padding with the last entry). I.e., one obtains factor 2 refinement every if <code class="docutils literal notranslate"><span class="pre">AmrMesh.ref_rat</span> <span class="pre">=</span> <span class="pre">2</span></code>.</p>
</div>
<p>Two gridding algorithms are supported, called Tiled mesh refinement the classical Berger-Rigoutsos refinement algorithm.
These are discussed in <a class="reference internal" href="SpatialDiscretization.html#chap-meshgeneration"><span class="std std-ref">Mesh generation</span></a>, and the user can specify which one to use by setting <code class="docutils literal notranslate"><span class="pre">AmrMesh.grid_algorithm</span></code> accordingly.
In general, the tiled algorithm is exceedingly more performant at larger scales.</p>
</section>
<section id="ghost-cells">
<h2>Ghost cells<a class="headerlink" href="#ghost-cells" title="Permalink to this heading"></a></h2>
<p>It is normally not necessary to adjust the number of ghost cells in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> simulations since most discretizations require at most 2 ghost cells.
Substantial efforts have been made to avoid increasing the required number of ghost cells.
Regardless, the number of ghost cells can be adjusted by setting <code class="docutils literal notranslate"><span class="pre">AmrMesh.num_ghost</span></code> to a specified value.
A companion parameter is <code class="docutils literal notranslate"><span class="pre">AmrMesh.eb_ghost</span></code>, which specifies the maximum number of ghost cells that are used when computing the cut-cell discretization.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One must always have <code class="docutils literal notranslate"><span class="pre">AmrMesh.eb_ghost</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">AmrMesh.num_ghost</span></code>.</p>
</div>
<p>Finally, it is possible to evaluate implicit functions on the mesh (e.g., for figuring out how far a cell is from a boundary).
It can be useful to include a larger ghost region in these data holders, which is adjusted by <code class="docutils literal notranslate"><span class="pre">AmrMesh.lsf_ghost</span></code>.</p>
</section>
<section id="multigrid-interpolation">
<h2>Multigrid interpolation<a class="headerlink" href="#multigrid-interpolation" title="Permalink to this heading"></a></h2>
<p>Multigrid interpolation is done using least squares reconstruction, as discussed in <a class="reference internal" href="LinearSolvers.html#chap-multigridinterpolation"><span class="std std-ref">Multigrid ghost cell interpolation</span></a>.
The user can set the order, radius, and least squares weighting for this interpolation by setting <code class="docutils literal notranslate"><span class="pre">AmrMesh.mg_interp_order</span></code>, <code class="docutils literal notranslate"><span class="pre">AmrMesh.mg_interp_radius</span></code>, and <code class="docutils literal notranslate"><span class="pre">AmrMesh.mg_interp_weight</span></code>.
Note that specifying <code class="docutils literal notranslate"><span class="pre">AmrMesh.mg_interp_radius</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">AmrMesh.eb_ghost</span></code> is sure to lead to a run-time error (possibly a segfault).</p>
</section>
<section id="interpolation-near-the-eb">
<h2>Interpolation near the EB<a class="headerlink" href="#interpolation-near-the-eb" title="Permalink to this heading"></a></h2>
<p>Most data in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> is cell-centered, although data can be interpolated or extrapolated to cell centroids and EB centroids.
The interpolation type is done by setting <code class="docutils literal notranslate"><span class="pre">AmrMesh.centroid_interp</span></code> and <code class="docutils literal notranslate"><span class="pre">AmrMesh.eb_interp</span></code> accordingly.
Currently, we support the following options:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">constant</span></code> i.e., use the cell centered value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code>, using bi/tri-linear interpolation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taylor</span></code>, using the Taylor series evaluated at the cell center.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsq</span></code>, using a first order unweighted least squares polynomial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pwl</span></code>, using piecewise linear reconstruction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minmod</span></code>, using a minmod slope limiter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">superbee</span></code>, using a superbee slope limiter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">monotonized_central</span></code>, using a van Leer slope limiter.</p></li>
</ol>
<p>Typically, one can just leave this option at <code class="docutils literal notranslate"><span class="pre">minmod</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="TimeStepper.html" class="btn btn-neutral float-left" title="TimeStepper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CellTagger.html" class="btn btn-neutral float-right" title="CellTagger" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SINTEF Energy Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>