<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brownian walker &mdash; chombo-discharge  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Electrostatics model" href="ElectrostaticsModel.html" />
    <link rel="prev" title="Advection-diffusion model" href="AdvectionDiffusionModel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chombo-discharge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Base/Documentation.html">Using this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Control.html">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Testing.html">Code testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/DesignOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ComputationalGeometry.html">ComputationalGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/TimeStepper.html">TimeStepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/AmrMesh.html">AmrMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/CellTagger.html">CellTagger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/SpatialDiscretization.html">Spatial discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ChomboBasics.html"><code class="docutils literal notranslate"><span class="pre">Chombo-3</span></code> basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/MeshData.html">Mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/LinearSolvers.html">Linear solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/VV.html">Verification and validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Electrostatics.html">Electrostatic solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Ito.html">Îto diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/KineticMonteCarlo.html">Kinetic Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/MeshODESolver.html">Mesh ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/SurfaceODESolver.html">Surface ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/TracerParticles.html">Tracer particles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-physics applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CdrPlasmaModel.html">CDR plasma model</a></li>
<li class="toctree-l1"><a class="reference internal" href="DischargeInceptionModel.html">Discharge inception model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ItoKMC.html">Îto-KMC plasma model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Single-solver applications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="AdvectionDiffusionModel.html">Advection-diffusion model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Brownian walker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initial-data">Initial data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transport-specification">Transport specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-stepping">Time stepping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#superparticle-handling">Superparticle handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solver-configuration">Solver configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-new-problem">Setting up a new problem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ElectrostaticsModel.html">Electrostatics model</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeometryModel.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="MeshODEModel.html">Mesh ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="RadiativeTransferModel.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="TracerParticleModel.html">Tracer particle model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/DataParser.html">Data parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LookupTable.html">LookupTable1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/RandomNumbers.html">Random numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LeastSquares.html">Least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/Contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/CodeStandard.html">Code standard</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZZReferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chombo-discharge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Brownian walker</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Applications/BrownianWalkerModel.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="brownian-walker">
<span id="chap-brownianwalkermodel"></span><h1>Brownian walker<a class="headerlink" href="#brownian-walker" title="Permalink to this heading"></a></h1>
<p>The Brownian walker model runs a single microscropic drift-diffusion using the <a class="reference internal" href="../Solvers/Ito.html#chap-itosolver"><span class="std std-ref">ItoSolver</span></a>, where the underlying transport kernel is</p>
<div class="math notranslate nohighlight">
\[d\mathbf{X} = \mathbf{V}dt + \sqrt{2Ddt}\mathbf{W}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is the spatial position of a particle <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> is the drift velocity and <span class="math notranslate nohighlight">\(D\)</span> is the diffusion coefficient <em>in the continuum limit</em>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Source code is located in <code class="file docutils literal notranslate"><span class="pre">$DISCHARGE_HOME/Physics/BrownianWalker</span></code>.</p>
</div>
<p>The model consists of the following implementation files:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">CD_BrownianWalkerStepper.H/cpp</span></code> which implements <a class="reference internal" href="../Source/TimeStepper.html#chap-timestepper"><span class="std std-ref">TimeStepper</span></a>.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">CD_BrownianWalkerSpecies.H/cpp</span></code> which implements initial conditions through <a class="reference internal" href="../Solvers/Ito.html#chap-itospecies"><span class="std std-ref">ItoSpecies</span></a>.</p></li>
</ul>
<section id="initial-data">
<h2>Initial data<a class="headerlink" href="#initial-data" title="Permalink to this heading"></a></h2>
<p>The initial data is randomly generated by sampling from an exponential distribution with specified radius and center.
The user can specify the number of particles, and control this sampling through the respective input options, see <a class="reference internal" href="#chap-brownianwalkerconfiguration"><span class="std std-ref">Solver configuration</span></a>.</p>
</section>
<section id="transport-specification">
<h2>Transport specification<a class="headerlink" href="#transport-specification" title="Permalink to this heading"></a></h2>
<p>The default velocity field for this class is</p>
<div class="math notranslate nohighlight">
\[\begin{split}v_x &amp;= -r\omega\sin\theta, \\
v_y &amp;=  r\omega\cos\theta, \\
v_z &amp;= 0,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r = \sqrt{x^2 + y^2}\)</span>, <span class="math notranslate nohighlight">\(\tan\theta = \frac{x}{y}\)</span>.
I.e. the flow field is a circulation around the Cartesian grid origin.
The diffusion coefficient is simply set to a constant value.</p>
<p>To adjust the velocity field or diffusion coefficients, adjust the configuration options given in <a class="reference internal" href="#chap-brownianwalkerconfiguration"><span class="std std-ref">Solver configuration</span></a>.</p>
</section>
<section id="time-stepping">
<h2>Time stepping<a class="headerlink" href="#time-stepping" title="Permalink to this heading"></a></h2>
<p>Time stepping in this module is performed using a simple Euler-Maruyama scheme, i.e.,</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^{k+1} = \mathbf{X}^{k} + \mathbf{V}\Delta t + \sqrt{2D\Delta t}\mathbf{W}\]</div>
<p>It is possible to adjust the time step size by setting the appropriate option (<code class="docutils literal notranslate"><span class="pre">BrownianWalker.cfl</span></code>).
The time step is then limited by a particle-like CFL time step condition on the advective part (i.e., on <span class="math notranslate nohighlight">\(\mathbf{V}\)</span>).</p>
</section>
<section id="superparticle-handling">
<h2>Superparticle handling<a class="headerlink" href="#superparticle-handling" title="Permalink to this heading"></a></h2>
<p>Superparticle handling in this module occurs via <a class="reference internal" href="../Solvers/Ito.html#chap-itosolver"><span class="std std-ref">ItoSolver</span></a>, so the user needs to specify the superparticle algorithm through the <a class="reference internal" href="../Solvers/Ito.html#chap-itosolver"><span class="std std-ref">ItoSolver</span></a> configuration options.
However, the <em>number</em> of superparticles is adjusted through <code class="docutils literal notranslate"><span class="pre">BrownianWalkerStepper</span></code>, and is set through <code class="docutils literal notranslate"><span class="pre">BrownianWalker.ppc</span></code>.
Setting this value to anything less than 1 will turn off super-particle handling.</p>
</section>
<section id="solver-configuration">
<span id="chap-brownianwalkerconfiguration"></span><h2>Solver configuration<a class="headerlink" href="#solver-configuration" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">BrownianWalkerStepper</span></code> class comes with user-configurable input options that can be adjusted at runtime.
The configuration options for <code class="docutils literal notranslate"><span class="pre">BrownianWalkerStepper</span></code> are given below:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># ====================================================================================================
# BrownianWalkerStepper class options.
# ====================================================================================================
BrownianWalker.verbosity          = -1        ## Verbosity
BrownianWalker.realm              = primal    ## Realm
BrownianWalker.diffusion          = true      ## Turn on/off diffusion
BrownianWalker.advection          = true      ## Turn on/off advection
BrownianWalker.blob_amplitude     = 1.0       ## Blob amplitude
BrownianWalker.blob_radius        = 0.1       ## Blob radius
BrownianWalker.blob_center        = 0 0       ## Blob center
BrownianWalker.seed               = 0         ## RNG seed
BrownianWalker.num_particles      = 100       ## Number of initial particles
BrownianWalker.cfl                = 1.0       ## CFL-like number.
BrownianWalker.ppc                = -1        ## Particles per cell. &lt;= 0 turns off superparticles
BrownianWalker.load_balance       = true      ## Turn on/off particle load balancing
BrownianWalker.which_balance      = mesh      ## Switch for load balancing method. Either &#39;mesh&#39; or &#39;particle&#39;.

# Velocity, diffusion, and CFL
# ----------------------------
BrownianWalker.mobility     = 1.0    ## Mobility coefficient
BrownianWalker.diffco       = 1.0    ## Diffusion coefficient
BrownianWalker.omega        = 1.0    ## Rotation velocity for advection field

# Cell tagging stuff
# ------------------
BrownianWalker.refine_curv     = 0.1     ## Refine if curvature exceeds this
BrownianWalker.refine_magn     = 1E-2    ## Only tag if magnitude eceeds this
BrownianWalker.buffer          = 0       ## Grow tagged cells
</pre></div>
</div>
</section>
<section id="setting-up-a-new-problem">
<h2>Setting up a new problem<a class="headerlink" href="#setting-up-a-new-problem" title="Permalink to this heading"></a></h2>
<p>To set up a new problem, using the Python setup tools in <code class="file docutils literal notranslate"><span class="pre">$DISCHARGE_HOME/Physics/BrownianWalker</span></code> is the simplest way.
A full description is available in the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> contained in the folder:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Physics/BrownianWalker</span>
This physics module solves for advection-diffusion process of a single scalar quantity. This module contains files for setting up the initial conditions
and species, integrators, and a cell tagger for refining grid cells. 

The source files consist of the following:

<span class="k">*</span><span class="w"> </span><span class="gs">**CD_BrownianWalkerSpecies.H/cpp**</span> Implementation of ItoSpecies, for setting up initial conditions and turning on/off advection and diffusion.
<span class="k">*</span><span class="w"> </span><span class="gs">**CD_BrownianWalkerTagger.H/cpp**</span>  Implementation of CellTagger, for flagging cells for refinement and coarsening.
<span class="k">*</span><span class="w"> </span><span class="gs">**CD_BrownianWalkerStepper.H/cpp**</span> Implementation of TimeStepper, for advancing the advection-diffusion equation. 

<span class="gu">## Setting up a new application</span>
To set up a new problem, use the Python script. For example:

<span class="sb">```shell</span>
python<span class="w"> </span>setup.py<span class="w"> </span>-base_dir<span class="o">=</span>/home/foo/MyApplications<span class="w"> </span>-app_name<span class="o">=</span>MyBrownianWalker<span class="w"> </span>-geometry<span class="o">=</span>Vessel
<span class="sb">```</span>

To install within chombo-discharge:

<span class="sb">```shell</span>
python<span class="w"> </span>setup.py<span class="w"> </span>-base_dir<span class="o">=</span><span class="nv">$DISCHARGE_HOME</span>/MyApplications<span class="w"> </span>-app_name<span class="o">=</span>MyBrownianWalker<span class="w"> </span>-geometry<span class="o">=</span>Vessel
<span class="sb">```</span>

The application will then be installed to $DISCHARGE_HOME/MyApplications/MyBrownianWalker.
The user will need to modify the geometry and set the initial conditions through the inputs file. 

<span class="gu">## Modifying the application</span>
The application is simply set up to advect and diffuse a scalar in a rotating flow.
Users are free to modify this application, e.g. adding new initial conditions and flow fields. 
</pre></div>
</div>
<p>To see available setup options, use</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>setup.py<span class="w"> </span>--help
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AdvectionDiffusionModel.html" class="btn btn-neutral float-left" title="Advection-diffusion model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ElectrostaticsModel.html" class="btn btn-neutral float-right" title="Electrostatics model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SINTEF Energy Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>