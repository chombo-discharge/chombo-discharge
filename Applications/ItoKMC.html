<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Îto-KMC plasma model &mdash; chombo-discharge  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advection-diffusion model" href="AdvectionDiffusionModel.html" />
    <link rel="prev" title="Discharge inception model" href="DischargeInceptionModel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chombo-discharge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Base/Documentation.html">Using this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Control.html">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Testing.html">Code testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/DesignOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ComputationalGeometry.html">ComputationalGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/TimeStepper.html">TimeStepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/AmrMesh.html">AmrMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/CellTagger.html">CellTagger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/GeoCoarsener.html">GeoCoarsener</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/SpatialDiscretization.html">Spatial discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ChomboBasics.html"><code class="docutils literal notranslate"><span class="pre">Chombo-3</span></code> basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/MeshData.html">Mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Regridding.html">Regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/LinearSolvers.html">Linear solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/VV.html">Verification and validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Electrostatics.html">Electrostatic solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/KineticMonteCarlo.html">Kinetic Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/MeshODESolver.html">Mesh ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/SurfaceODESolver.html">Surface ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/TracerParticles.html">Tracer particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Ito.html">Îto diffusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-physics applications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CdrPlasmaModel.html">CDR plasma model</a></li>
<li class="toctree-l1"><a class="reference internal" href="DischargeInceptionModel.html">Discharge inception model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Îto-KMC plasma model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#underlying-model">Underlying model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plasma-transport">Plasma transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photoionization">Photoionization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#field-interaction">Field interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chemistry">Chemistry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#algorithms">Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-stepping">Time stepping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particle-placement">Particle placement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-diffusion">Parallel diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spatial-filtering">Spatial filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reaction-network">Reaction network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particle-management">Particle management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-chemistry">0D chemistry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#itokmcphysics">ItoKMCPhysics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#species-definitions">Species definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plasma-reactions">Plasma reactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Photoionization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-reactions">Surface reactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transport-coefficients">Transport coefficients</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#json-0d-chemistry-interface">JSON 0D chemistry interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gas-law">Gas law</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ideal-gas">Ideal gas</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#background-species">Background species</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#name">Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#molar-fraction">Molar fraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#townsend-coefficients">Townsend coefficients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#automatic">Automatic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Constant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tabulated-vs-e-n">Tabulated vs <span class="math notranslate nohighlight">\(E/N\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Plotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plasma-species">Plasma species</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-definition">Basic definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mobility-and-diffusion-coefficients">Mobility and diffusion coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="#temperature">Temperature</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initial-particles">Initial particles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#photon-species">Photon species</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Basic definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#absorption-coefficient">Absorption coefficient</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Plasma reactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reaction-specifiers">Reaction specifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rate-calculation">Rate calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scaling">Scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#efficiency">Efficiency</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quenching">Quenching</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gradient-correction">Gradient correction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understanding-reaction-rates">Understanding reaction rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting-rates">Plotting rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#printing-rates">Printing rates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Particle placement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">Photoionization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secondary-emission">Secondary emission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#field-emission">Field emission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#warnings-and-caveats">Warnings and caveats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#higher-order-reactions">Higher-order reactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Townsend coefficients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tips-and-tricks">Tips and tricks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-programs">Example programs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Single-solver applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="AdvectionDiffusionModel.html">Advection-diffusion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="BrownianWalkerModel.html">Brownian walker</a></li>
<li class="toctree-l1"><a class="reference internal" href="ElectrostaticsModel.html">Electrostatics model</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeometryModel.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="MeshODEModel.html">Mesh ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="RadiativeTransferModel.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="TracerParticleModel.html">Tracer particle model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/DataParser.html">Data parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LookupTable.html">Lookup tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/RandomNumbers.html">Random numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/LeastSquares.html">Least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/Contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/CodeStandard.html">Code standard</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZZReferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chombo-discharge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Îto-KMC plasma model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Applications/ItoKMC.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ito-kmc-plasma-model">
<span id="chap-itokmc"></span><h1>Îto-KMC plasma model<a class="headerlink" href="#ito-kmc-plasma-model" title="Permalink to this heading"></a></h1>
<section id="underlying-model">
<h2>Underlying model<a class="headerlink" href="#underlying-model" title="Permalink to this heading"></a></h2>
<section id="plasma-transport">
<h3>Plasma transport<a class="headerlink" href="#plasma-transport" title="Permalink to this heading"></a></h3>
<p>The Îto-KMC model uses an Îto solver for some of the species, i.e. the particles drift and diffuse according to</p>
<div class="math notranslate nohighlight">
\[d\mathbf{X} = \mathbf{V}dt + \sqrt{2D dt},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is the particle position and <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> is the particle drift velocity and diffusion coefficients, respectively.
These are obtained by interpolating the macroscopic drift velocity and diffusion coefficients to the particle position.
Further details regarding the Îto method are given in <a class="reference internal" href="../Solvers/Ito.html#chap-itosolver"><span class="std std-ref">ItoSolver</span></a>.</p>
<p>Not all species in the Îto-KMC model need to be defined by particle solvers, as some species can be tracked by more conventional advection-diffusion-reaction solvers, see <a class="reference internal" href="../Solvers/CDR.html#chap-cdrsolver"><span class="std std-ref">CdrSolver</span></a> for discretization details.</p>
</section>
<section id="photoionization">
<h3>Photoionization<a class="headerlink" href="#photoionization" title="Permalink to this heading"></a></h3>
<p>Photoionization in the Îto-KMC model is done using discrete photons.
These are generated and advanced in every time step, and interact with the plasma through user-defined photo-reactions.
The underlying solver is the discrete Monte Carlo photon transport solver, see <a class="reference internal" href="../Solvers/RTE.html#chap-montecarlorte"><span class="std std-ref">Monte Carlo sampling</span></a>.</p>
</section>
<section id="field-interaction">
<h3>Field interaction<a class="headerlink" href="#field-interaction" title="Permalink to this heading"></a></h3>
<p>The Îto-KMC model uses an electrostatic approximation where the field is obtained by solving the Poisson equation for the potential.
See <a class="reference internal" href="../Solvers/Electrostatics.html#chap-electrostatics"><span class="std std-ref">Electrostatic solver</span></a> for further details.</p>
</section>
<section id="chemistry">
<h3>Chemistry<a class="headerlink" href="#chemistry" title="Permalink to this heading"></a></h3>
<p>Kinetic Monte Carlo (KMC) is used within grid cells for resolving the plasma chemistry.
The algorithmic concepts are given in <a class="reference internal" href="../Solvers/KineticMonteCarlo.html#chap-kineticmontecarlo"><span class="std std-ref">Kinetic Monte Carlo</span></a>.</p>
</section>
</section>
<section id="algorithms">
<h2>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this heading"></a></h2>
<section id="time-stepping">
<h3>Time stepping<a class="headerlink" href="#time-stepping" title="Permalink to this heading"></a></h3>
<p>The Îto-KMC model has adaptive time step controls and no fundamental CFL limitation.
Currently, the time step can be restricted through several means:</p>
<ol class="arabic simple">
<li><p>A physics-based time step, which is proportional to the non-critical time step from the KMC integrator.</p></li>
<li><p>A particle advective, diffusive, or advective-diffusive CFL limitation, both upper and lower bounds.</p></li>
<li><p>A CFL-condition on the convection-diffusion-reaction solvers.</p></li>
<li><p>A limit that restricts the time step to a factor proportional to the dielectric relaxation time.</p></li>
<li><p>Hard limits, placing upper and lower bounds on the time step.</p></li>
</ol>
<p>In addition, the user can specify the maximum permitted growth or reduction in the time step.</p>
<p>These limits are given by the following input variables:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>ItoKMCGodunovStepper.physics_dt_factor                     = 1.0     ## Physics-based time step factor
ItoKMCGodunovStepper.min_particle_advection_cfl            = 0.0     ## Advective time step CFL restriction
ItoKMCGodunovStepper.max_particle_advection_cfl            = 1.0     ## Advective time step CFL restriction
ItoKMCGodunovStepper.min_particle_diffusion_cfl            = 0.0     ## Diffusive time step CFL restriction
ItoKMCGodunovStepper.max_particle_diffusion_cfl            = 1.E99   ## Diffusive time step CFL restriction
ItoKMCGodunovStepper.min_particle_advection_diffusion_cfl  = 0.0     ## Advection-diffusion time step CFL restriction
ItoKMCGodunovStepper.max_particle_advection_diffusion_cfl  = 1.E99   ## Advection-diffusion time step CFL restriction
ItoKMCGodunovStepper.fluid_advection_diffusion_cfl         = 0.5     ## Advection-diffusion time step CFL restriction
ItoKMCGodunovStepper.relax_dt_factor                       = 100.0   ## Relaxation time step restriction.
ItoKMCGodunovStepper.min_dt                                = 0.0     ## Minimum permitted time step
ItoKMCGodunovStepper.max_dt                                = 1.E99   ## Maximum permitted time step
ItoKMCGodunovStepper.max_growth_dt                         = 1.E99   ## Maximum permitted time step increase (dt * factor)
ItoKMCGodunovStepper.max_shrink_dt                         = 1.E99   ## Maximum permissible time step reduction (dt/factor)
</pre></div>
</div>
</section>
<section id="particle-placement">
<h3>Particle placement<a class="headerlink" href="#particle-placement" title="Permalink to this heading"></a></h3>
<p>The KMC algorithm resolves the number of particles that are generated or lost within each grid cell, leaving substantial freedom in how one distributes new particles (or remove older ones). We currently support three methods for placing new particles:</p>
<ol class="arabic simple">
<li><p>Place all particles on the cell centroid.</p></li>
<li><p>Randomly distribute the new particles within the grid cell.</p></li>
<li><p>Compute an upstream position within the grid cell and randomly distribute the particles in the downstream region.</p></li>
</ol>
<p>The methods each have their advantages and disadvantages.
Placing all new particles on the cell centroid has the advantage that there will be no spurious space charge effects arising in the grid cell.
Randomly distributing the new particles has the advantage that it generates secondary particles more evenly over the reaction region.
Both these methods (<code class="docutils literal notranslate"><span class="pre">centroid</span></code> and <code class="docutils literal notranslate"><span class="pre">random</span></code>) are, however, sources of numerical diffusion since the secondary particles are potentially placed in the wake of the primary particles (which is non-physical).
The downstream method circumvents this source of numerical diffusion by only placing secondary particles in the downstream region of some user-defined species (typically the electrons).
See <a class="reference internal" href="#chap-itokmcjson"><span class="std std-ref">JSON 0D chemistry interface</span></a> for instructions on how to assign the particle placement method.</p>
</section>
<section id="parallel-diffusion">
<h3>Parallel diffusion<a class="headerlink" href="#parallel-diffusion" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ItoKMCGodunovStepper</span></code> can limit diffusion against the electric field (or strictly speaking, the particle drift direction) by setting the flag <code class="docutils literal notranslate"><span class="pre">ItoKMCGodunovStepper.limit_parallel_diffusion</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.
The logic behind this functionality is that in a drift-diffusion approximation, and regardless of whether or one uses particles or fluids, electrons that back-diffuse against the electric field will rapidly lose their energy and can then no longer ionize the gas.
When limiting parallel diffusion, the diffusion hop of the particles is restricted to being along or transverse to the drift direction.
In practice, this leads to greatly enhanced stability in, especially in cathode sheaths.</p>
</section>
<section id="spatial-filtering">
<h3>Spatial filtering<a class="headerlink" href="#spatial-filtering" title="Permalink to this heading"></a></h3>
<p>It is possible to apply filtering of the space-charge density prior to the field advance in order to reduce the impact of discrete particle noise.
Filters are applied as follows:</p>
<div class="math notranslate nohighlight">
\[\rho_i = \alpha\rho_i + \frac{1-\alpha}{2}\left(\rho_{i+s} + \rho_{i-s}\right).\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is a filtering factor and <span class="math notranslate nohighlight">\(s\)</span> a stride.
Users can apply this filtering by adjusting the following input options:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>ItoKMCGodunovStepper.rho_filter_num        = 0    # Number of filterings for the space-density
ItoKMCGodunovStepper.rho_filter_max_stride = 1    # Maximum stride for filter
ItoKMCGodunovStepper.rho_filter_alpha      = 0.5  # Filtering factor (0.5 is a bilinear filter)
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Spatial filtering of the space-charge density is a work-in-progress which may yield unexpected results.
Bugs may or may not be present.
Users should exercise caution when using this feature.</p>
</div>
</section>
<section id="reaction-network">
<h3>Reaction network<a class="headerlink" href="#reaction-network" title="Permalink to this heading"></a></h3>
</section>
<section id="particle-management">
<h3>Particle management<a class="headerlink" href="#particle-management" title="Permalink to this heading"></a></h3>
</section>
<section id="d-chemistry">
<h3>0D chemistry<a class="headerlink" href="#d-chemistry" title="Permalink to this heading"></a></h3>
<p>The user input interface to the Îto-KMC model consists of a zero-dimensional plasma kinetics interface called <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code>.
This interface consists of the following main functionalities:</p>
<ol class="arabic simple">
<li><p>User-defined species, and which solver types (Îto or CDR) to use when tracking them.</p></li>
<li><p>User-defined initial particles, reaction kinetics, and photoionization processes.</p></li>
</ol>
<section id="itokmcphysics">
<span id="chap-itokmcphysics"></span><h4>ItoKMCPhysics<a class="headerlink" href="#itokmcphysics" title="Permalink to this heading"></a></h4>
<p>The complete C++ interface specification is given below.
Because the interface is fairly extensive, <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> also supplies a JSON-based implementation called <code class="docutils literal notranslate"><span class="pre">ItoKMCJSON</span></code> (see <a class="reference internal" href="#chap-itokmcjson"><span class="std std-ref">JSON 0D chemistry interface</span></a>) for defining these things through file input.
The difference between <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code> and its implementation <code class="docutils literal notranslate"><span class="pre">ItoKMCJSON</span></code> is that the JSON-based implementation class only implements a subset of potential features supported by <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code>.</p>
<details>
<summary><a>Show/hide full 0D interface</a></summary><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/* chombo-discharge</span>
<span class="cm"> * Copyright © 2021 SINTEF Energy Research.</span>
<span class="cm"> * Please refer to Copyright.txt and LICENSE in the chombo-discharge root directory.</span>
<span class="cm"> */</span>

<span class="cm">/*!</span>
<span class="cm">  @file   CD_ItoKMCPhysics.H</span>
<span class="cm">  @brief  Main file for describing Ito-based plasma physics</span>
<span class="cm">  @author Robert Marskar</span>
<span class="cm">*/</span>

<span class="cp">#ifndef CD_ItoKMCPhysics_H</span>
<span class="cp">#define CD_ItoKMCPhysics_H</span>

<span class="c1">// Std includes</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="c1">// Chombo includes</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;RealVect.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;RefCountedPtr.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;List.H&gt;</span>

<span class="c1">// Our includes</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_ItoSpecies.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_CdrSpecies.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_RtSpecies.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_Photon.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_ItoParticle.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_PointParticle.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_ItoKMCPhotoReaction.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_ItoKMCSurfaceReactionSet.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_KMCDualState.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_KMCDualStateReaction.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_KMCSolver.H&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_NamespaceHeader.H&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">Physics</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ItoKMC</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief Numerical representation of the KMC state. Can be floating-point or integer type</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">FPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Real</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief KMC state used in the Kinetic Monte Carlo advancement</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">KMCState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KMCDualState</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief KMC reaction used in the Kinetic Monte Carlo advancement</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">KMCReaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KMCDualStateReaction</span><span class="o">&lt;</span><span class="n">KMCState</span><span class="p">,</span><span class="w"> </span><span class="n">FPR</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief KMC solverl type used in the Kinetic Monte carlo advancement</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">KMCSolverType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KMCSolver</span><span class="o">&lt;</span><span class="n">KMCReaction</span><span class="p">,</span><span class="w"> </span><span class="n">KMCState</span><span class="p">,</span><span class="w"> </span><span class="n">FPR</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief Map to species type</span>
<span class="cm">      @details This is just for distinguishing between species that are treated with an Ito or CDR formalism</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">enum</span><span class="w"> </span><span class="nc">SpeciesType</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">Ito</span><span class="p">,</span>
<span class="w">      </span><span class="n">CDR</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="cm">/*!</span>
<span class="cm">      @brief Base class for interaction between Kinetic Monte Carlo and Ito-based plasma solvers. </span>
<span class="cm">      @details When using this class, the user should populate m_kmcReactions with the appropriate reactions AND implement routines</span>
<span class="cm">      for computing the mobility/diffusion coefficeints. </span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="nc">ItoKMCPhysics</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="o">:</span>
<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Constructor. Does nothing.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="n">ItoKMCPhysics</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Destructor. Does nothing. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">ItoKMCPhysics</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Define the KMC solver and state</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">defineKMC</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Kill the KMC solver</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">killKMC</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get the neutral density at a position in space</span>
<span class="cm">	@param[in] a_pos Physical position</span>
<span class="cm">	@return Neutral density</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Real</span>
<span class="w">      </span><span class="nf">getNeutralDensity</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Compute Townsend ionization coefficient</span>
<span class="cm">	@param[in] a_E Electric field magnitude</span>
<span class="cm">	@param[in] a_x Physical coordinate</span>
<span class="cm">	@return Should return the Townsend ionization coefficient. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Real</span>
<span class="w">      </span><span class="nf">computeAlpha</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_E</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_x</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Compute Townsend attachment coefficient</span>
<span class="cm">	@param[in] a_E Electric field magnitude</span>
<span class="cm">	@param[in] a_x Physical coordinate</span>
<span class="cm">	@return Should return the Townsend attachment coefficient. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Real</span>
<span class="w">      </span><span class="nf">computeEta</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_E</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_x</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get all particle drift-diffusion species</span>
<span class="cm">	@return m_itoSpecies</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">ItoSpecies</span><span class="o">&gt;&gt;&amp;</span>
<span class="w">      </span><span class="n">getItoSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get all fluid drift-diffusion species</span>
<span class="cm">	@return m_cdrSpecies</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">CdrSpecies</span><span class="o">&gt;&gt;&amp;</span>
<span class="w">      </span><span class="n">getCdrSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get all photon species</span>
<span class="cm">	@return m_rtSpecies</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">RtSpecies</span><span class="o">&gt;&gt;&amp;</span>
<span class="w">      </span><span class="n">getRtSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get number of plot variables</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">getPlotVariableNames</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get plot variables</span>
<span class="cm">	@param[in] a_E       Electric field</span>
<span class="cm">	@param[in] a_pos     Physical position</span>
<span class="cm">	@param[in] a_phi     Plasma species densities</span>
<span class="cm">	@param[in] a_gradPhi Density gradients for plasma species. </span>
<span class="cm">	@param[in] a_dx      Grid resolution</span>
<span class="cm">	@param[in] a_kappa   Cut-cell volume fraction</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">getPlotVariables</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">          </span><span class="n">a_E</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">          </span><span class="n">a_pos</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;&amp;</span><span class="w">     </span><span class="n">a_phi</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RealVect</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a_gradPhi</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">              </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">              </span><span class="n">a_kappa</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get number of plot variables</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span>
<span class="w">      </span><span class="nf">getNumberOfPlotVariables</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Return number of Ito solvers.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">int</span>
<span class="w">      </span><span class="nf">getNumItoSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Return number of CDR solvers.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">int</span>
<span class="w">      </span><span class="nf">getNumCdrSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Return total number of plasma species.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">int</span>
<span class="w">      </span><span class="nf">getNumPlasmaSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Return number of RTE solvers.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">int</span>
<span class="w">      </span><span class="nf">getNumPhotonSpecies</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Return true/false if physics model needs species gradients.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">      </span><span class="nf">needGradients</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Get the internal mapping between plasma species and Ito solvers</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">SpeciesType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span>
<span class="w">      </span><span class="n">getSpeciesMap</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Parse run-time options</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">parseRuntimeOptions</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Set initial surface charge. Default is 0, override if you want.</span>
<span class="cm">	@param[in] a_time Simulation time</span>
<span class="cm">	@param[in] a_pos  Physical coordinate</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="k">virtual</span><span class="w"> </span><span class="n">Real</span>
<span class="w">      </span><span class="nf">initialSigma</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_time</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_pos</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Compute the Ito solver mobilities.</span>
<span class="cm">	@param[in] a_time Time</span>
<span class="cm">	@param[in] a_pos  Position</span>
<span class="cm">	@param[in] a_E    Electric field</span>
<span class="cm">	@return Must return a vector of non-negative mobility coefficients for the plasma species</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">computeMobilities</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_time</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_pos</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_E</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Compute the Ito solver diffusion coefficients</span>
<span class="cm">	@param[in] a_time Time</span>
<span class="cm">	@param[in] a_pos  Position</span>
<span class="cm">	@param[in] a_E    Electric field</span>
<span class="cm">	@return Must return a vector of non-negative diffusion coefficients for the plasma species</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">computeDiffusionCoefficients</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_time</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_pos</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w"> </span><span class="n">a_E</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Resolve secondary emission at the EB.</span>
<span class="cm">	@details Routine is here to handle charge injection, secondary emission etc.</span>
<span class="cm">	@param[out] a_secondaryParticles Outgoing plasma species particles.</span>
<span class="cm">	@param[out] a_cdrFluxes          CDR fluxes for CDR species.</span>
<span class="cm">	@param[out] a_secondaryPhotons   Photons injected through the EB.</span>
<span class="cm">	@param[in]  a_primaryParticles   Particles that left the computational domain through the EB.</span>
<span class="cm">	@param[in]  a_cdrFluxesExtrap    Extrapolated CDR fluxes.</span>
<span class="cm">	@param[in]  a_primaryPhotons     Photons that left the computational domain through the EB.</span>
<span class="cm">	@param[in]  a_newNumParticles    Total number of particles in the cut-cell AFTER the transport step.</span>
<span class="cm">	@param[in]  a_oldNumParticles    Total number of particles in the cut-cell BEFORE the transport step.</span>
<span class="cm">	@param[in]  a_electricField      Electric field.                  </span>
<span class="cm">	@param[in]  a_physicalCellCenter Physical position of the cell center. </span>
<span class="cm">	@param[in]  a_cellCentroid       Cell centroid relative to the cell center (not multiplied by dx).</span>
<span class="cm">	@param[in]  a_bndryCentroid      EB face centroid relative to the cell center (not multiplied by dx).</span>
<span class="cm">	@param[in]  a_bndryNormal        Cut-cell normal vector. </span>
<span class="cm">	@param[in]  a_bndryArea          Cut-cell boundary area - not multiplied by dx (2D) or dx^2 (3D).</span>
<span class="cm">	@param[in]  a_dx                 Grid resolution on this level. </span>
<span class="cm">	@param[in]  a_dt                 Time step.</span>
<span class="cm">	@param[in]  a_isDielectric       Dielectric or electrode. </span>
<span class="cm">	@param[in]  a_matIndex           Material index (taken from computationalGeometry).</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">secondaryEmissionEB</span><span class="p">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;&gt;&amp;</span><span class="w">       </span><span class="n">a_secondaryParticles</span><span class="p">,</span>
<span class="w">                          </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;&amp;</span><span class="w">                    </span><span class="n">a_cdrFluxes</span><span class="p">,</span>
<span class="w">                          </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Photon</span><span class="o">&gt;&gt;&amp;</span><span class="w">            </span><span class="n">a_secondaryPhotons</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">a_primaryParticles</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;&amp;</span><span class="w">              </span><span class="n">a_cdrFluxesExtrap</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Photon</span><span class="o">&gt;&gt;&amp;</span><span class="w">      </span><span class="n">a_primaryPhotons</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                  </span><span class="n">a_E</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                  </span><span class="n">a_physicalCellCenter</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                  </span><span class="n">a_cellCentroid</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                  </span><span class="n">a_bndryCentroid</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                  </span><span class="n">a_bndryNormal</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                       </span><span class="n">a_bndryArea</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                       </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                       </span><span class="n">a_dt</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w">                       </span><span class="n">a_isDielectric</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w">                        </span><span class="n">a_matIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Advance particles. </span>
<span class="cm">	@param[inout] a_numParticles  Number of physical particles</span>
<span class="cm">	@param[out]   a_numNewPhotons Number of new physical photons to generate (of each type)</span>
<span class="cm">	@param[out]   a_criticalDt    Critical KMC time step computed at end of integration</span>
<span class="cm">	@param[out]   a_nonCriticalDt Non-critical KMC time step computed at end of integration	</span>
<span class="cm">	@param[in]    a_phi           Plasma species densities. </span>
<span class="cm">	@param[in]    a_gradPhi       Plasma species density gradients. </span>
<span class="cm">	@param[in]    a_dt            Time step</span>
<span class="cm">	@param[in]    a_E             Electric field</span>
<span class="cm">	@param[in]    a_pos           Physical position</span>
<span class="cm">	@param[in]    a_dx            Grid resolution</span>
<span class="cm">	@param[in]    a_kappa         Cut-cell volume fraction. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">advanceKMC</span><span class="p">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;&amp;</span><span class="w">            </span><span class="n">a_numParticles</span><span class="p">,</span>
<span class="w">                 </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;&amp;</span><span class="w">            </span><span class="n">a_numNewPhotons</span><span class="p">,</span>
<span class="w">                 </span><span class="n">Real</span><span class="o">&amp;</span><span class="w">                   </span><span class="n">a_criticalDt</span><span class="p">,</span>
<span class="w">                 </span><span class="n">Real</span><span class="o">&amp;</span><span class="w">                   </span><span class="n">a_nonCriticalDt</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;&amp;</span><span class="w">     </span><span class="n">a_phi</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RealVect</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a_gradPhi</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">              </span><span class="n">a_dt</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">          </span><span class="n">a_E</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">          </span><span class="n">a_pos</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">              </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">              </span><span class="n">a_kappa</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Reconcile the number of particles.</span>
<span class="cm">	@details This will add/remove particles and potentially also adjust the particle weights.</span>
<span class="cm">	@param[inout] a_particles Computational particles</span>
<span class="cm">	@param[in]    a_newNumParticles New number of particles (i.e., after the KMC advance)</span>
<span class="cm">	@param[in]    a_oldNumParticles Previous number of particles (i.e., before the KMC advance)</span>
<span class="cm">	@param[in]    a_electricField   Electric field in cell</span>
<span class="cm">	@param[in]    a_cellPos         Cell center position</span>
<span class="cm">	@param[in]    a_centroidPos     Cell centroid position</span>
<span class="cm">	@param[in]    a_loCorner        Low corner of minimum box enclosing the cut-cell</span>
<span class="cm">	@param[in]    a_hiCorner        High corner of minimum box enclosing the cut-cell</span>
<span class="cm">	@param[in]    a_bndryCentroid   Cut-cell boundary centroid</span>
<span class="cm">	@param[in]    a_bndryNormal     Cut-cell normal (pointing into the domain)</span>
<span class="cm">	@param[in]    a_dx              Grid resolution</span>
<span class="cm">	@param[in]    a_kappa           Cut-cell volume fraction. </span>
<span class="cm">	@note Public because this is called by ItoKMCStepper</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">reconcileParticles</span><span class="p">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;*&gt;&amp;</span><span class="w"> </span><span class="n">a_particles</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;&amp;</span><span class="w">          </span><span class="n">a_newNumParticles</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;&amp;</span><span class="w">          </span><span class="n">a_oldNumParticles</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_electricField</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_cellPos</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_centroidPos</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_lo</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_hi</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_bndryCentroid</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">              </span><span class="n">a_bndryNormal</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                  </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                  </span><span class="n">a_kappa</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Generate new photons. </span>
<span class="cm">	@details This will add photons</span>
<span class="cm">	@param[in] a_newPhotons      New photons</span>
<span class="cm">	@param[in] a_numNewPhotons   Number of physical photons to be generated. </span>
<span class="cm">	@param[in] a_cellPos         Cell center position</span>
<span class="cm">	@param[in] a_centroidPos     Cell centroid position</span>
<span class="cm">	@param[in] a_loCorner        Low corner of minimum box enclosing the cut-cell</span>
<span class="cm">	@param[in] a_hiCorner        High corner of minimum box enclosing the cut-cell</span>
<span class="cm">	@param[in] a_bndryCentroid   Cut-cell boundary centroid</span>
<span class="cm">	@param[in] a_bndryNormal     Cut-cell normal (pointing into the domain)</span>
<span class="cm">	@param[in] a_dx              Grid resolution</span>
<span class="cm">	@param[in] a_kappa           Cut-cell volume fraction. </span>
<span class="cm">	@note Public because this is called by ItoKMCStepper</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">reconcilePhotons</span><span class="p">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Photon</span><span class="o">&gt;*&gt;&amp;</span><span class="w"> </span><span class="n">a_newPhotons</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">FPR</span><span class="o">&gt;&amp;</span><span class="w">     </span><span class="n">a_numNewPhotons</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_cellPos</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_centroidPos</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_lo</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_hi</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_bndryCentroid</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">         </span><span class="n">a_bndryNormal</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">             </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">             </span><span class="n">a_kappa</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Reconcile photoionization reactions.</span>
<span class="cm">	@param[inout] a_itoPrticles       Particle products placed in Ito solvers. </span>
<span class="cm">	@param[inout] a_cdrParticles      Particle products placed in CDR solvers. </span>
<span class="cm">	@param[in]    a_absorbedPhotons Photons absorbed on the mesh. </span>
<span class="cm">	@details This runs through the photo-reactions and associates photo-ionization products. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">reconcilePhotoionization</span><span class="p">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;*&gt;&amp;</span><span class="w">   </span><span class="n">a_itoParticles</span><span class="p">,</span>
<span class="w">                               </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">PointParticle</span><span class="o">&gt;*&gt;&amp;</span><span class="w"> </span><span class="n">a_cdrParticles</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Photon</span><span class="o">&gt;*&gt;&amp;</span><span class="w">  </span><span class="n">a_absorbedPhotons</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">    </span><span class="k">protected</span><span class="o">:</span>
<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Enum for switching between KMC algorithms</span>
<span class="cm">	@details &#39;SSA&#39; is the Gillespie algorithm, &#39;Tau&#39; is tau-leaping and &#39;Hybrid&#39; is the Cao et. al. algorithm. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Algorithm</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="n">SSA</span><span class="p">,</span>
<span class="w">        </span><span class="n">ExplicitEuler</span><span class="p">,</span>
<span class="w">        </span><span class="n">Midpoint</span><span class="p">,</span>
<span class="w">        </span><span class="n">PRC</span><span class="p">,</span>
<span class="w">        </span><span class="n">ImplicitEuler</span><span class="p">,</span>
<span class="w">        </span><span class="n">HybridExplicitEuler</span><span class="p">,</span>
<span class="w">        </span><span class="n">HybridMidpoint</span><span class="p">,</span>
<span class="w">        </span><span class="n">HybridPRC</span><span class="p">,</span>
<span class="w">        </span><span class="n">HybridImplicitEuler</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Enum for switching between various particle placement algorithms</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ParticlePlacement</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="n">Random</span><span class="p">,</span>
<span class="w">        </span><span class="n">Centroid</span><span class="p">,</span>
<span class="w">        </span><span class="n">Downstream</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Algorithm to use for KMC advance</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Algorithm</span><span class="w"> </span><span class="n">m_algorithm</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Particle placement algorithm</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">ParticlePlacement</span><span class="w"> </span><span class="n">m_particlePlacement</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Map for associating a plasma species with an Ito solver or CDR solver.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">SpeciesType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m_speciesMap</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Class name. Used for options parsing</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">m_className</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Turn on/off debugging</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_debug</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Is defined or not</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_isDefined</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Is the KMC solver defined or not.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">static</span><span class="w"> </span><span class="k">thread_local</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_hasKMCSolver</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Kinetic Monte Carlo solver used in advanceReactionNetwork.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">static</span><span class="w"> </span><span class="k">thread_local</span><span class="w"> </span><span class="n">KMCSolverType</span><span class="w"> </span><span class="n">m_kmcSolver</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief KMC state used in advanceReactionNetwork.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">static</span><span class="w"> </span><span class="k">thread_local</span><span class="w"> </span><span class="n">KMCState</span><span class="w"> </span><span class="n">m_kmcState</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief KMC reactions used in advanceReactionNetowkr</span>
<span class="cm">	@note This is set up via setupKMC in order toi ensure OpenMP thread safety when calling advanceReactionNetwork. The vector</span>
<span class="cm">	is later depopulated in killKMC().</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">static</span><span class="w"> </span><span class="k">thread_local</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">KMCReaction</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m_kmcReactionsThreadLocal</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief List of reactions for the KMC solver</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">KMCReaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_kmcReactions</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief List of photoionization reactions</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ItoKMCPhotoReaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_photoReactions</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Random number generators for photoionization pathways. </span>
<span class="cm">	@details The first index is the photon index, i.e. entry in m_photonSpecies. The second index in the</span>
<span class="cm">	map is an RNG generator for selecting photo-reactions, and a map which associates the returned</span>
<span class="cm">	reaction from the RNG generator with an index in m_photoReactions.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">discrete_distribution</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">m_photoPathways</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Surface reactions.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">ItoKMCSurfaceReactionSet</span><span class="w"> </span><span class="n">m_surfaceReactions</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief List of solver-tracked particle drift-diffusion species. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">ItoSpecies</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m_itoSpecies</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief List of solver-tracked fluid drift-diffusion species. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">CdrSpecies</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m_cdrSpecies</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief List of solver-tracked photon species. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">RtSpecies</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">m_rtSpecies</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief An internal integer describing which species is the &quot;ionizing&quot; species.</span>
<span class="cm">	@details This is used by the particle reconciliation routine when only placing secondary particles</span>
<span class="cm">	in the downstream region of the primary particles. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_downstreamSpecies</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Maximum new number of particles generated by the chemistry advance</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_maxNewParticles</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Maximum new number of photons generated by the chemistry advance</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_maxNewPhotons</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Solver setting for the Cao et. al algorithm. </span>
<span class="cm">	@details Determines critical reactions. A reaction is critical if it is m_Ncrit firings away from depleting a reactant. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_Ncrit</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Solver setting for the Cao et. al algorithm. </span>
<span class="cm">	@details Maximum number of SSA steps to run when switching into SSA-based advancement for non-critical reactions. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_NSSA</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Maximum number of iterations for implicit KMC-leaping algorithms</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">m_maxIter</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Solver setting for the Cao et. al. algorithm. </span>
<span class="cm">	@details Equal to the maximum permitted change in the relative propensity for non-critical reactions</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Real</span><span class="w"> </span><span class="n">m_SSAlim</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Solver setting for the Cao et. al. algorithm. </span>
<span class="cm">	@details Equal to the maximum permitted change in the relative propensity for non-critical reactions</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Real</span><span class="w"> </span><span class="n">m_eps</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Exit tolerance for implicit KMC-leaping algorithms</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="n">Real</span><span class="w"> </span><span class="n">m_exitTol</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Define method -- defines all the internal machinery</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">define</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Build internal representation of how we distinguish the Ito and CDR solvers</span>
<span class="cm">	@note This should ALWAYS be called after initializing the species since ItoKMCStepper will rely on it. </span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">defineSpeciesMap</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Define pathways for photo-reactions</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">definePhotoPathways</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Parse the maximum number of particles generated per cell</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">parsePPC</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Parse the maximum number of particles generated per cell</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">parseDebug</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Parse reaction algorithm</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">parseAlgorithm</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Update reaction rates</span>
<span class="cm">	@param[out] a_kmcReactions Reaction rates to be set. </span>
<span class="cm">	@param[in] a_E       Electric field</span>
<span class="cm">	@param[in] a_pos     Physical position</span>
<span class="cm">	@param[in] a_phi     Plasma species densities</span>
<span class="cm">	@param[in] a_gradPhi Density gradients for plasma species.</span>
<span class="cm">	@param[in] a_dt      Time step</span>
<span class="cm">	@param[in] a_dx      Grid resolution</span>
<span class="cm">	@param[in] a_kappa   Cut-cell volume fraction</span>
<span class="cm">	@note Must be implemented by the user.</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">updateReactionRates</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">KMCReaction</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">a_kmcReactions</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">                                   </span><span class="n">a_E</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="w">                                   </span><span class="n">a_pos</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;&amp;</span><span class="w">                              </span><span class="n">a_phi</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">RealVect</span><span class="o">&gt;&amp;</span><span class="w">                          </span><span class="n">a_gradPhi</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                                       </span><span class="n">a_dt</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                                       </span><span class="n">a_dx</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w">                                       </span><span class="n">a_kappa</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Remove particles from the input list.</span>
<span class="cm">	@details This will remove weight from the input particles if we can. Otherwise we remove full particles. </span>
<span class="cm">	@param[inout] a_particles   List of (super-)particles to remove from. </span>
<span class="cm">	@param[in]    a_numToRemove Number of physical particles to remove from the input list</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span>
<span class="w">      </span><span class="nf">removeParticles</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a_particles</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">a_numToRemove</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>

<span class="w">      </span><span class="cm">/*!</span>
<span class="cm">	@brief Compute the upstream position in a grid cell. Returns false if an upstream position was undefinable.</span>
<span class="cm">	@details This routine will compute the position of the &quot;most upstream&quot; particle in the input list.</span>
<span class="cm">	For all particles we assume that they advect in the direction of Z*E, where Z is the charge number.</span>
<span class="cm">	This routine also computes the minimum bounding box (in unit coordinates) that encloses the downstreamn</span>
<span class="cm">	region within the grid cell.</span>
<span class="cm">	@param[out] a_pos Upstream position.</span>
<span class="cm">	@param[out] a_lo  Minimum coordinate of the downstream region (relative to the unit cell)</span>
<span class="cm">	@param[out] a_hi  Maximum coordinate of the downstream region (relative to the unit cell)</span>
<span class="cm">	@param[in] a_Z Particle charge number</span>
<span class="cm">	@param[in] a_particles Particles where we look for an upstream position.</span>
<span class="cm">	@param[in] a_electricField Electric field vector</span>
<span class="cm">	@param[in] a_cellPos Physical location of the cell center</span>
<span class="cm">	@param[in] a_dx Grid resolution</span>
<span class="cm">      */</span>
<span class="w">      </span><span class="kr">inline</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">      </span><span class="nf">computeUpstreamPosition</span><span class="p">(</span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                </span><span class="n">a_pos</span><span class="p">,</span>
<span class="w">                              </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                </span><span class="n">a_lo</span><span class="p">,</span>
<span class="w">                              </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">                </span><span class="n">a_hi</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w">               </span><span class="n">a_Z</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ItoParticle</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">a_particles</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">          </span><span class="n">a_electricField</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">RealVect</span><span class="o">&amp;</span><span class="w">          </span><span class="n">a_cellPos</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="o">&amp;</span><span class="w">              </span><span class="n">a_dx</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="c1">// namespace ItoKMC</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace Physics</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_NamespaceFooter.H&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_ItoKMCPhysicsImplem.H&gt;</span>

<span class="cp">#endif</span>
</pre></div>
</div>
</details><br></section>
<section id="species-definitions">
<h4>Species definitions<a class="headerlink" href="#species-definitions" title="Permalink to this heading"></a></h4>
<p>Species are defined either as input species for CDR solvers (see <a class="reference internal" href="../Solvers/CDR.html#chap-cdrsolver"><span class="std std-ref">CdrSolver</span></a>) or Îto solvers (see <a class="reference internal" href="../Solvers/Ito.html#chap-itosolver"><span class="std std-ref">ItoSolver</span></a>).
It is sufficient to populate the <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code> species vectors <code class="docutils literal notranslate"><span class="pre">m_cdrSpecies</span></code> and <code class="docutils literal notranslate"><span class="pre">m_itoSpecies</span></code> if one only wants to initialize the solvers.
See <a class="reference internal" href="#chap-itokmcphysics"><span class="std std-ref">ItoKMCPhysics</span></a> for their C++ definition.
In addition to actually populating the vectors, users will typically also include initial conditions for the species.
The interfaces permit initial particles for the Îto solvers, while the CDR solvers permit particles <em>and</em> initial density functions.
Additionally, one must define all species associated with radiative transfer solvers.</p>
</section>
<section id="plasma-reactions">
<span id="chap-itokmcplasmareaction"></span><h4>Plasma reactions<a class="headerlink" href="#plasma-reactions" title="Permalink to this heading"></a></h4>
<p>Plasma reactions in the Îto-KMC model are represented stoichiometrically as</p>
<div class="math notranslate nohighlight">
\[A + B + \ldots \xrightarrow{c} C + D + \ldots\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the KMC rate coefficient, i.e. <em>not the rate coefficient from the reaction rate equation</em>.
An arbitrary number of reactions is supported, but currently the reaction mechanisms are limited to:</p>
<ul class="simple">
<li><p>The left-hand side must consist only of species that are tracked by a CDR or Îto solver.</p></li>
<li><p>The right-hand side can consist of species tracked by a CDR solver, an Îto solver, or a radiative transfer solver.</p></li>
</ul>
<p>These rules apply only to the internal C++ interface; implementations of this interface will typically also allow species defined as ‘’background species’’, i.e. species that are not tracked by a solver.
In that case, the interface implementation must absorb the background species contribution into the rate constant.</p>
<p>In the KMC algorithm, one operates with chemical propensities rather than rate coefficients.
For example, the chemical propensity <span class="math notranslate nohighlight">\(a_1\)</span> for a reaction <span class="math notranslate nohighlight">\(A + B \xrightarrow{c_1}\varnothing\)</span> is</p>
<div class="math notranslate nohighlight">
\[a_1 = c_1X_AX_B,\]</div>
<p>and from the macroscopic limit <span class="math notranslate nohighlight">\(X_A \gg 1\)</span>, <span class="math notranslate nohighlight">\(X_B \gg 1\)</span> one may in fact also derive that <span class="math notranslate nohighlight">\(c_1 = k_1/\Delta V\)</span> where <span class="math notranslate nohighlight">\(k_1\)</span> is the rate coefficient from the reaction rate equation, i.e. where <span class="math notranslate nohighlight">\(\partial_t n_A = -k_1n_An_B\)</span>.
Note that if the reaction was <span class="math notranslate nohighlight">\(A + A\xrightarrow{c_2}\varnothing\)</span> then the propensity is</p>
<div class="math notranslate nohighlight">
\[a_2 = \frac{1}{2}c_2X_A\left(X_A-1\right)\]</div>
<p>since there are <span class="math notranslate nohighlight">\(\frac{1}{2}X_A\left(X_A-1\right)\)</span> distinct pairs of particles of type <span class="math notranslate nohighlight">\(A\)</span>.
Likewise, the fluid rate coefficient would be <span class="math notranslate nohighlight">\(k_2 = c_2\Delta V/2\)</span>.</p>
<p>The distinction between KMC and fluid rates is an important one; the reaction representation used in the Îto-KMC model only operates with the KMC rates <span class="math notranslate nohighlight">\(c_j\)</span>, and it is us to the user to ensure that these are consistent with the fluid limit.
Internally, these reactions are implemented through the dual state KMC implementation, see <a class="reference internal" href="../Solvers/KineticMonteCarlo.html#chap-kmcdualstate"><span class="std std-ref">KMCDualState</span></a>.
During the reaction advance the user only needs to update the <span class="math notranslate nohighlight">\(c_j\)</span> coefficients (typically done via an interface implementation); the calculation of the propensity is automatic and follows the standard KMC rules (e.g., the KMC solver accounts for the number of distinct pairs of particles).
This must be done in the routine <code class="docutils literal notranslate"><span class="pre">updateReactionRates(...)</span></code>, see <a class="reference internal" href="#chap-itokmcphysics"><span class="std std-ref">ItoKMCPhysics</span></a> for the complete specification.</p>
</section>
<section id="id1">
<h4>Photoionization<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>Photo-reactions are also represented stoichiometrically as</p>
<div class="math notranslate nohighlight">
\[\gamma \xrightarrow{\xi} A + B + \ldots,\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi\)</span> is the photo-reaction efficiency, i.e. the probability that the photon <span class="math notranslate nohighlight">\(\gamma\)</span> causes a reaction when it is absorbed on the mesh.
Currently, photons can only be generated through <em>plasma reactions</em>, see <a class="reference internal" href="#chap-itokmcplasmareaction"><span class="std std-ref">Plasma reactions</span></a>, and we do not permit reactions between the photon and plasma species.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We currently only support constant photoionization probabilities <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code> adds some flexibility when dealing with photo-reactions as it permits pre-evaluation of photoionization probabilities.
That is, when generating photons through reactions of the type <span class="math notranslate nohighlight">\(A + B \rightarrow \gamma\)</span>, one may scale the reaction by the photoionization probability <span class="math notranslate nohighlight">\(\xi\)</span> so that only ionizing photons are generated and then write the photo-reaction as <span class="math notranslate nohighlight">\(\gamma \xrightarrow{\xi=1} A + B + \ldots\)</span>.
However, this process becomes more complicated when dealing with multiple photo-reaction pathways, e.g.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\gamma &amp;\xrightarrow{\xi_1} A + B, \\
\gamma &amp;\xrightarrow{\xi_2} A + B, \\\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi_1\)</span> and <span class="math notranslate nohighlight">\(\xi_2\)</span> are the probabilities that the photon <span class="math notranslate nohighlight">\(\gamma\)</span> triggers the reaction.
If only a single physical photon is absorbed, then one must stochastically determine which pathway is triggered.
There are two ways of doing this:</p>
<ol class="arabic simple">
<li><p>Pre-scale the photon generation by <span class="math notranslate nohighlight">\(\xi_1 + \xi_2\)</span>, and then determine the pathway through the relative probabilities <span class="math notranslate nohighlight">\(\xi_1/\left(\xi_1+\xi_2\right)\)</span> and <span class="math notranslate nohighlight">\(\xi_2/\left(\xi_1+\xi_2\right)\)</span>.</p></li>
<li><p>Do not scale the photon generation reaction and determine the pathway through the absolute probabilities <span class="math notranslate nohighlight">\(\xi_1\)</span> and <span class="math notranslate nohighlight">\(\xi_2\)</span>.
This can imply a large computational cost since one will have to track all photons that are generated.</p></li>
</ol>
<p>The former method is normally the preferred way as it can lead to reductions in computational complexity and particle noise, but for flexibility <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code> supports both of these.
The latter method can be of relevance if users wants precise descriptions of photons that trigger both photoionizing reactions and surface reactions (e.g., secondary electron emission).</p>
<p>An alternative is to split the photon type <span class="math notranslate nohighlight">\(\gamma\)</span> into volumetrically absorbed and surface absorbed photon species <span class="math notranslate nohighlight">\(\gamma_v\)</span> and <span class="math notranslate nohighlight">\(\gamma_s\)</span>.
In this case one may pre-scale the photon-generating reactions by the photo-reaction probabilities <span class="math notranslate nohighlight">\(\xi\)</span> (for volume absorption) and <span class="math notranslate nohighlight">\(\zeta\)</span> (for surface absorption) as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A + B &amp;\xrightarrow{k\rightarrow k\xi}\gamma_v, \\
A + B &amp;\xrightarrow{k\rightarrow k\zeta}\gamma_s.\end{split}\]</div>
<p>Volumetric and surface absorption is then treated independently</p>
<div class="math notranslate nohighlight">
\[\begin{split}\gamma_v &amp;\xrightarrow{\left(\xi=1\right)}, \ldots\\
\gamma_s &amp;\xrightarrow{\left(\zeta=1\right)} \ldots.\end{split}\]</div>
<p>This type of pre-evaluation of the photo-reaction pathways is sensible in a statistical sense, but loses meaning if only a single photon is involved.</p>
</section>
<section id="surface-reactions">
<h4>Surface reactions<a class="headerlink" href="#surface-reactions" title="Permalink to this heading"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Surface reactions are supported by <a class="reference internal" href="#chap-itokmcphysics"><span class="std std-ref">ItoKMCPhysics</span></a> but not implemented in the JSON interface (yet).</p>
</div>
</section>
<section id="transport-coefficients">
<h4>Transport coefficients<a class="headerlink" href="#transport-coefficients" title="Permalink to this heading"></a></h4>
<p>Species mobilities and diffusion coefficients should be computed just as they are done in the fluid approximation.
The <code class="docutils literal notranslate"><span class="pre">ItoKMCPhysics</span></code> interface requires implementations of two functions that define the coefficients as functions of <span class="math notranslate nohighlight">\(\mu = \mu\left(t,\mathbf{x}, \mathbf{E}\right)\)</span>,
and likewise for the diffusion coefficients.
Note that these functions should return the <em>fluid coefficients</em>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is currently no support for computing <span class="math notranslate nohighlight">\(\mu\)</span> as a function of the species densities (e.g., the electron density), but this only requires modest extensions of the Îto-KMC module.</p>
</div>
</section>
</section>
</section>
<section id="json-0d-chemistry-interface">
<span id="chap-itokmcjson"></span><h2>JSON 0D chemistry interface<a class="headerlink" href="#json-0d-chemistry-interface" title="Permalink to this heading"></a></h2>
<p>The JSON-based chemistry interface (called <code class="docutils literal notranslate"><span class="pre">ItoKMCJSON</span></code>) simplifies the definition of the plasma kinetics and initial conditions by permitting specifications through a JSON file.
In addition, the JSON specification will permit the definition of background species that are not tracked as solvers (but that simply exist as a density function).
The JSON interface thus provides a simple entry point for users that have no interest in defining the chemistry from scratch.</p>
<p>Several mandatory fields are required when specifying the plasma kinetics, such as:</p>
<ul class="simple">
<li><p>Gas pressure, temperature, and number density.</p></li>
<li><p>Background species (if any).</p></li>
<li><p>Townsend coefficients.</p></li>
<li><p>Plasma species and their initial conditions, which solver to use when tracking them.</p></li>
<li><p>Photon species and their absorption lengths.</p></li>
<li><p>Plasma reactions.</p></li>
<li><p>Photoionization reactions.</p></li>
</ul>
<p>These specifications follow a pre-defined JSON format which is discussed in detail below.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While JSON files do not formally support comments, the JSON submodule used by <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> allows them.</p>
</div>
<section id="gas-law">
<h3>Gas law<a class="headerlink" href="#gas-law" title="Permalink to this heading"></a></h3>
<p>The JSON gas law represents a loose definition of the gas pressure, temperature, and <em>number density</em>.
Multiple gas laws can be defined in the JSON file, and the user can then select which one to use.
This is defined within a JSON entry <code class="docutils literal notranslate"><span class="pre">gas</span></code> and a subentry <code class="docutils literal notranslate"><span class="pre">law</span></code>.
In the <code class="docutils literal notranslate"><span class="pre">gas/law</span></code> field one must specify an <code class="docutils literal notranslate"><span class="pre">id</span></code> field which indicates which gas law to use.
One may also set an optional field <code class="docutils literal notranslate"><span class="pre">plot</span></code> to true/false if one wants to include the pressure, temperature, and density in the HDF5 output files.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Gas parameters are specified in SI units.</p>
</div>
<p>Each user-defined gas law exists as a separate entry in the <code class="docutils literal notranslate"><span class="pre">gas/law</span></code> field, and the minimum requirements for these are that they contain a <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier.
Currently, the supported types are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ideal</span></code> (for constant ideal gas)</p></li>
</ul>
<p>An example JSON specification is given below.</p>
<details>
<summary><a>Example gas law specification</a></summary><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Specify which gas law we use. The user can define multiple gas laws and then later specify which one to use.</span>
<span class="w">      </span><span class="nt">&quot;law&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my_ideal_gas&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Specify which gas law we use.</span>
<span class="w">         </span><span class="nt">&quot;plot&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">         </span><span class="c1">// Turn on/off plotting.</span>
<span class="w">         </span><span class="nt">&quot;my_ideal_gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="c1">// Definition for an ideal gas law. Temperature is always in Kelvin the pressure is in Pascal. The neutral density</span>
<span class="w">             </span><span class="c1">// is derived using an ideal gas law.</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ideal&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;temperature&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;pressure&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1E5</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</details><br><section id="ideal-gas">
<h4>Ideal gas<a class="headerlink" href="#ideal-gas" title="Permalink to this heading"></a></h4>
<p>When specifying that the gas law <code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">ideal</span></code>, the user must further specify the temperature and pressure of the gas.</p>
<details>
<summary><a>Example ideal gas specification</a></summary><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;law&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my_ideal_gas&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Specify which gas law we use.</span>
<span class="w">         </span><span class="nt">&quot;my_ideal_gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ideal&quot;</span><span class="p">,</span><span class="w">    </span><span class="c1">// Ideal gas law type</span>
<span class="w">             </span><span class="nt">&quot;temperature&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="c1">// Temperature must be in Kelvin</span>
<span class="w">             </span><span class="nt">&quot;pressure&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w">     </span><span class="c1">// Pressure must be in bar</span>
<span class="w">         </span><span class="p">},</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</details><br></section>
</section>
<section id="background-species">
<h3>Background species<a class="headerlink" href="#background-species" title="Permalink to this heading"></a></h3>
<p>Background species <span class="math notranslate nohighlight">\(i\)</span> are defined as continuous background densities <span class="math notranslate nohighlight">\(N_i\)</span> given by</p>
<div class="math notranslate nohighlight">
\[N_i\left(\mathbf{x}\right) = \chi_i\left(\mathbf{x}\right)N\left(\mathbf{x}\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(\chi_i\left(\mathbf{x}\right)\)</span> is the molar fraction of species <span class="math notranslate nohighlight">\(i\)</span> (typically, but not necessarily, a constant).</p>
<p>When specifying background species, the user must include an array of background species in the <code class="docutils literal notranslate"><span class="pre">gas</span></code> JSON field.
For example,</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;background species&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// First species goes here</span>
<span class="w">         </span><span class="p">},</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Second species goes here</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The order of appearance of the background species does not matter.</p>
<section id="name">
<h4>Name<a class="headerlink" href="#name" title="Permalink to this heading"></a></h4>
<p>The species name is specified by including an <code class="docutils literal notranslate"><span class="pre">id</span></code> field, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;background species&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="hll"><span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2&quot;</span>
</span><span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="molar-fraction">
<h4>Molar fraction<a class="headerlink" href="#molar-fraction" title="Permalink to this heading"></a></h4>
<p>The molar fraction can be specified in various forms by including a field <code class="docutils literal notranslate"><span class="pre">molar</span> <span class="pre">fraction</span></code>.
This field also requires the user to specify the <em>type</em> of molar fraction.
In principle, the molar fraction can have a positional dependency.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There’s no internal renormalization of the molar fractions input by the user.
Internal inconsitencies will occur if the user supplies inputs molar fractions that sum to a number different than one.</p>
<p>Various checks will be enabled if the user compiles in debug-mode (see <a class="reference internal" href="../Base/Installation.html#chap-installation"><span class="std std-ref">Installation</span></a>), but these checks are not guaranteed to catch all cases.</p>
</div>
<section id="constant">
<h5>Constant<a class="headerlink" href="#constant" title="Permalink to this heading"></a></h5>
<p>To specify a constant molar fraction, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to constant and specify the value.
An example JSON specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;background species&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;O2&quot;</span><span class="w">             </span><span class="c1">// Species name</span>
<span class="hll"><span class="w">            </span><span class="nt">&quot;molar fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// Molar fraction specification</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Constant molar fraction</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="w">        </span><span class="c1">// Molar fraction value</span>
</span><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="tabulated-versus-height">
<h5>Tabulated versus height<a class="headerlink" href="#tabulated-versus-height" title="Permalink to this heading"></a></h5>
<p>The molar fraction can be set as a tabulated value versus one of the Cartesian coordinate axis by setting the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">table</span> <span class="pre">vs</span> <span class="pre">height</span></code>.
The input data should be tabulated in column form, e.g.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span># height       molar fraction
0              0.1
1              0.1
2              0.1
</pre></div>
</div>
<p>The file parser (see <span class="xref std std-ref">LookupTable</span>) will ignore the header file if it starts with a hashtag (#).
Various other inputs are then also required:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> File name containing the height vs. molar fraction data (required).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> Cartesian axis to associate with the height coordinate (required).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height</span> <span class="pre">column</span></code> Column in data file containing the height (optional, defaults to 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molar</span> <span class="pre">fraction</span> <span class="pre">column</span></code> Column in data file containing the molar fraction (optional, defaults to 1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height</span> <span class="pre">scale</span></code> Scaling of height column (optional).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fraction</span> <span class="pre">scale</span></code> Scaling (optional).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">height</span></code> Truncate data to minimum height (optional, applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">height</span></code> Truncate data to maximum height (optional, applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">points</span></code> Number of points to keep in table representation (optional, defaults to 1000).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> Spacing table representation (optional, defaults to “linear”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dump</span></code> Option for dumping tabulated data to file.</p></li>
</ul>
<p>An example JSON specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;background species&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;O2&quot;</span><span class="w">                           </span><span class="c1">// Species name</span>
<span class="hll"><span class="w">            </span><span class="nt">&quot;molar fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">                  </span><span class="c1">// Molar fraction specification</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table vs height&quot;</span><span class="p">,</span><span class="w">        </span><span class="c1">// Constant molar fraction</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;file&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2_molar_fraction.dat&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// File name containing molar fraction</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;dump&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;debug_O2_fraction.dat&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Optional debugging hook for dumping table to file</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;axis&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Axis which represents the &quot;height&quot;</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;height column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">              </span><span class="c1">// Optional specification of column containing the height data (defaults to 0)</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;molar fraction column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">      </span><span class="c1">// Optional specification of column containing the height data (defaults to 1)</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;height scale&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">             </span><span class="c1">// Optional scaling of height column</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;fraction scale&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">           </span><span class="c1">// Optional scaling of molar fraction column</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;min height&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">               </span><span class="c1">// Optional truncation of minimum height kept in internal table (occurs after scaling)</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;max height&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w">               </span><span class="c1">// Optional truncation of maximum height kept in internal table (occurs after scaling)</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;num points&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">               </span><span class="c1">// Optional specification of number of data points kept in internal table (defaults to 1000)</span>
</span><span class="hll"><span class="w">               </span><span class="nt">&quot;spacing&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linear&quot;</span><span class="w">              </span><span class="c1">// Optional specification of table representation. Can be &#39;linear&#39; or &#39;exponential&#39; (defaults to linear)</span>
</span><span class="w">            </span><span class="p">}</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="plotting">
<h4>Plotting<a class="headerlink" href="#plotting" title="Permalink to this heading"></a></h4>
<p>Background species densities can be included in HDF5 plots by including an optional field <code class="docutils literal notranslate"><span class="pre">plot</span></code>.
For example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;gas&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;background species&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;O2&quot;</span><span class="w">             </span><span class="c1">// Species name</span>
<span class="w">            </span><span class="nt">&quot;molar fraction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// Molar fraction specification</span>
<span class="w">               </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Constant molar fraction</span>
<span class="w">               </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="w">        </span><span class="c1">// Molar fraction value</span>
<span class="w">            </span><span class="p">},</span>
<span class="hll"><span class="w">            </span><span class="nt">&quot;plot&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">           </span><span class="c1">// Plot number density in HDF5 or not</span>
</span><span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="townsend-coefficients">
<h3>Townsend coefficients<a class="headerlink" href="#townsend-coefficients" title="Permalink to this heading"></a></h3>
<p>Townsend ionization and attachment coefficients <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> must be specified, and have two usages:</p>
<ol class="arabic simple">
<li><p>Flagging cells for refinement (users can override this).</p></li>
<li><p>Potential usage in plasma reactions (which requires particular care, see <a class="reference internal" href="#chap-itokmcwarnings"><span class="std std-ref">Warnings and caveats</span></a>.</p></li>
</ol>
<p>These are specified by including JSON entries <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">eta</span></code>, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;alpha&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="c1">// alpha-coefficient specification goes here</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;eta&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="c1">// eta-coefficient specification goes here</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are various way of specifying these, as discussed below:</p>
<section id="automatic">
<h4>Automatic<a class="headerlink" href="#automatic" title="Permalink to this heading"></a></h4>
<p>In auto-mode the Townsend coefficients for the electrons is automatically derived from the user-specified list of reactions.
E.g., the Townsend ionization coefficient is computed as</p>
<div class="math notranslate nohighlight">
\[\alpha = \frac{\sum k}{\mu E},\]</div>
<p>where <span class="math notranslate nohighlight">\(\sum k\)</span> is the sum of all ionizing reactions, also incorporating the neutral density.
The advantage of this approach is that one may choose to discard some of the reactions from e.g. BOLSIG+ output but without recomputing the Townsend coefficients.</p>
<p>To automatically set Townsend coefficients, set <code class="docutils literal notranslate"><span class="pre">type</span></code> to auto and specify the species that is involved, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;alpha&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The advantage of using auto-mode for the coefficients is that one automatically ensures consistency between the user-specified list of reactions and the</p>
</section>
<section id="id2">
<h4>Constant<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>To set a constant Townsend coefficient, set <code class="docutils literal notranslate"><span class="pre">type</span></code> to constant and then specify the value, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;alpha&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E5</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="tabulated-vs-e-n">
<h4>Tabulated vs <span class="math notranslate nohighlight">\(E/N\)</span><a class="headerlink" href="#tabulated-vs-e-n" title="Permalink to this heading"></a></h4>
<p>To set the coefficient as functions <span class="math notranslate nohighlight">\(f = f\left(E/N\right)\)</span>, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">table</span> <span class="pre">vs</span> <span class="pre">E/N</span></code> and specify the following fields:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> For specifying the file containing the input data, which must be organized as column data, e.g.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span># E/N   alpha/N
0       1E5
100     1E5
200     1E5
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code> For specifying where in the file one starts reading data.
This is an optional argument intended for use with BOLSIG+ output data where the user specifies that the data is contained in the lines below the specified header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E/N</span> <span class="pre">column</span></code> For setting which column in the data file contains the values of <span class="math notranslate nohighlight">\(E/N\)</span> (optional, defaults to 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha/N</span> <span class="pre">column</span></code> For setting which column in the data file contains the values of <span class="math notranslate nohighlight">\(\alpha/N\)</span>.
Note that this should be replaced by <code class="docutils literal notranslate"><span class="pre">eta/N</span> <span class="pre">column</span></code> when parsing the attachment coefficient.
This is an optional argument that defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">E/N</span></code> Optional scaling of the column containing the <span class="math notranslate nohighlight">\(E/N\)</span> data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">alpha/N</span></code> Optional scaling of the column containing the <span class="math notranslate nohighlight">\(\alpha/N\)</span> data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">points</span></code> Number of data points in internal table representation (optional, defaults to 1000).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> Spacing in internal table representation. Can be <code class="docutils literal notranslate"><span class="pre">linear</span></code> or <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.
This is an optional argument that defaults to <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dump</span></code> A string specifier for writing the table representation of <span class="math notranslate nohighlight">\(E/N, \alpha/N\)</span> to file.</p></li>
</ul>
<p>An example JSON specification that uses a BOLSIG+ output file for parsing the data is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;alpha&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table vs E/N&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// Specify that we read in alpha/N vs E/N</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;file&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bolsig_air.dat&quot;</span><span class="p">,</span><span class="w">                                 </span><span class="c1">// File containing the data</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;dump&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;debug_alpha.dat&quot;</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Optional dump of internalized table to file. Useful for debugging.</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;header&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E/N (Td)\tTownsend ioniz. coef. alpha/N (m2)&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Optional argument. Contains line immediately preceding the data to be read.</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;E/N column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                                          </span><span class="c1">// Optional specification of column containing E/N (defaults to 0)</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;alpha/N column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                                      </span><span class="c1">// Optional specification of column containing alpha/N (defaults to 1)</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;min E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                                           </span><span class="c1">// Optional truncation of minium E/N kept when resampling the table (occurs after scaling)</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;max E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span><span class="w">                                        </span><span class="c1">// Optional truncation of maximum E/N kept when resampling the table (happens after scaling)</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;num points&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">                                       </span><span class="c1">// Optional number of points kept when resamplnig the table (defaults to 1000)</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;spacing&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exponential&quot;</span><span class="p">,</span><span class="w">                                 </span><span class="c1">// Optional spcification of table representation. Defaults to &#39;exponential&#39; but can also be &#39;linear&#39;</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;scale E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                                         </span><span class="c1">// Optional scaling of the column containing E/N</span>
</span><span class="hll"><span class="w">       </span><span class="nt">&quot;scale alpha/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                                      </span><span class="c1">// Optional scaling</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id3">
<h4>Plotting<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<p>To include the Townsend coefficients as mesh variables in HDF5 files, include the <code class="docutils literal notranslate"><span class="pre">plot</span></code> specifier, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;alpha&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;plot&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="plasma-species">
<h3>Plasma species<a class="headerlink" href="#plasma-species" title="Permalink to this heading"></a></h3>
<p>Plasma species are species that are tracked using either a CDR or Îto solver.
The user must specify the following information:</p>
<ul class="simple">
<li><p>An ID/name for the species.</p></li>
<li><p>The species’ charge number.</p></li>
<li><p>The solver type, i.e. whether or not it is tracked by a particle or fluid solver.</p></li>
<li><p>Whether or not the species is mobile/diffusive.
If the species is mobile/diffusive, the mobility/diffusion coefficient must also be specified.</p></li>
<li><p>Optionally, the species temperature.
If not specified, the temperature will be set to the background gas temperature.</p></li>
<li><p>Initial particles for the solvers.</p></li>
</ul>
<section id="basic-definition">
<h4>Basic definition<a class="headerlink" href="#basic-definition" title="Permalink to this heading"></a></h4>
<p>Species are defined by an array of entries in a <code class="docutils literal notranslate"><span class="pre">plasma</span> <span class="pre">species</span></code> JSON field.
Each species <em>must</em> specify the following fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> (string) For setting the species name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Z</span></code> (integer) For setting the species’ charge number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver</span></code> (string) For specifying whether or not the species is tracked by a CDR or Îto solver.
Acceptable values are <em>cdr</em> and <em>ito</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mobile</span></code> (boolean) For specifying whether or not the species is mobile.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mobile</span></code> (boolean) For specifying whether or not the species is diffusive.</p></li>
</ul>
<p>An example specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="c1">// List of plasma species that are tracked. This is an array of species</span>
<span class="w">    </span><span class="c1">// with various identifiers, some of which are always required (id, Z, type, mobile, diffusive) and</span>
<span class="w">    </span><span class="c1">// others which are secondary requirements.</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// Species ID</span>
<span class="w">        </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">           </span><span class="c1">// Charge number</span>
<span class="w">        </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1">// Solver type. Either &#39;ito&#39; or &#39;cdr&#39;</span>
<span class="w">        </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">    </span><span class="c1">// Mobile or not</span>
<span class="w">        </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c1">// Diffusive or not</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Definition of O2+ plasma species.</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2+&quot;</span><span class="p">,</span><span class="w">            </span><span class="c1">// Species ID</span>
<span class="w">        </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                </span><span class="c1">// Charge number</span>
<span class="w">        </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cdr&quot;</span><span class="p">,</span><span class="w">       </span><span class="c1">// CDR solver.</span>
<span class="w">        </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="c1">// Not mobile.</span>
<span class="w">        </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">     </span><span class="c1">// Not diffusive</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note that the order of appearance of the various species is irrelevant.
However, if a species is specified as mobile/diffusive, the user <em>must</em> also specify the corresponding transport coefficients.</p>
</section>
<section id="mobility-and-diffusion-coefficients">
<h4>Mobility and diffusion coefficients<a class="headerlink" href="#mobility-and-diffusion-coefficients" title="Permalink to this heading"></a></h4>
<p>Mobility and diffusion coefficients are specified by including fields <code class="docutils literal notranslate"><span class="pre">mobility</span></code> and <code class="docutils literal notranslate"><span class="pre">diffusion</span></code> that further specifies how the transport coefficients are calculated.
Note that the input to these fields should be <em>fluid transport coefficients</em>.
These fields can be specified in various forms, as shown below.</p>
<section id="id4">
<h5>Constant<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h5>
<p>To set a constant coefficient, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to constant and then assign the value.
For example,</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Species ID</span>
<span class="w">         </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">              </span><span class="c1">// Charge number</span>
<span class="w">         </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">      </span><span class="c1">// Solver type. Either &#39;ito&#39; or &#39;cdr&#39;</span>
<span class="w">         </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">       </span><span class="c1">// Mobile or not</span>
<span class="w">         </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">     </span><span class="c1">// Diffusive or not,</span>
<span class="w">         </span><span class="nt">&quot;mobility&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Set constant mobility</span>
<span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.02</span>
<span class="hll"><span class="w">         </span><span class="p">},</span>
</span><span class="hll"><span class="w">         </span><span class="nt">&quot;diffusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Set constant diffusion coefficient</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2E-4</span>
</span><span class="hll"><span class="w">         </span><span class="p">}</span>
</span><span class="hll"><span class="w">     </span><span class="p">}</span>
</span><span class="hll"><span class="w"> </span><span class="p">]</span>
</span></pre></div>
</div>
</section>
<section id="constant-n">
<h5>Constant <span class="math notranslate nohighlight">\(*N\)</span><a class="headerlink" href="#constant-n" title="Permalink to this heading"></a></h5>
<p>To set a coefficient that is constant vs <span class="math notranslate nohighlight">\(N\)</span>, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">constant</span> <span class="pre">mu*N</span></code> or <code class="docutils literal notranslate"><span class="pre">constant</span> <span class="pre">D*N</span></code> and then assign the value.
For example,</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Species ID</span>
<span class="w">         </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">                   </span><span class="c1">// Charge number</span>
<span class="w">         </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">           </span><span class="c1">// Solver type. Either &#39;ito&#39; or &#39;cdr&#39;</span>
<span class="w">         </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">            </span><span class="c1">// Mobile or not</span>
<span class="w">         </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">          </span><span class="c1">// Diffusive or not,</span>
<span class="w">         </span><span class="nt">&quot;mobility&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant mu*N&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Set mu*N to a constant</span>
<span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E24</span>
<span class="hll"><span class="w">         </span><span class="p">},</span>
</span><span class="hll"><span class="w">         </span><span class="nt">&quot;diffusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant D*N&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// Set D*N to a constant</span>
</span><span class="hll"><span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5E24</span>
</span><span class="hll"><span class="w">         </span><span class="p">}</span>
</span><span class="hll"><span class="w">     </span><span class="p">}</span>
</span><span class="hll"><span class="w"> </span><span class="p">]</span>
</span></pre></div>
</div>
</section>
<section id="table-vs-e-n">
<h5>Table vs <span class="math notranslate nohighlight">\(E/N\)</span><a class="headerlink" href="#table-vs-e-n" title="Permalink to this heading"></a></h5>
<p>To set the transport coefficients as functions <span class="math notranslate nohighlight">\(f = f\left(E/N\right)\)</span>, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">table</span> <span class="pre">vs</span> <span class="pre">E/N</span></code> and specify the following fields:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> For specifying the file containing the input data, which must be organized as column data, e.g.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span># E/N   mu/N
0       1E5
100     1E5
200     1E5
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code> For specifying where in the file one starts reading data.
This is an optional argument intended for use with BOLSIG+ output data where the user specifies that the data is contained in the lines below the specified header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E/N</span> <span class="pre">column</span></code> For setting which column in the data file contains the values of <span class="math notranslate nohighlight">\(E/N\)</span> (optional, defaults to 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu*N</span> <span class="pre">column</span></code> For setting which column in the data file contains the values of <span class="math notranslate nohighlight">\(\mu N\)</span> (or alternatively <span class="math notranslate nohighlight">\(DN\)</span> for the diffusion coefficient).
This is an optional argument that defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E/N</span> <span class="pre">scale</span></code> Optional scaling of the column containing the <span class="math notranslate nohighlight">\(E/N\)</span> data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu*N</span> <span class="pre">scale</span></code> Optional scaling of the column containing the <span class="math notranslate nohighlight">\(\mu N\)</span> data (or alternatively <span class="math notranslate nohighlight">\(DN\)</span> for the diffusion coefficient).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">points</span></code> Number of data points in internal table representation (optional, defaults to 1000).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> Spacing in internal table representation. Can be <code class="docutils literal notranslate"><span class="pre">linear</span></code> or <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.
This is an optional argument that defaults to <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dump</span></code> A string specifier for writing the table representation of <span class="math notranslate nohighlight">\(E/N, \mu N\)</span> to file.</p></li>
</ul>
<p>An example JSON specification that uses a BOLSIG+ output file for parsing the data for the mobility is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                                       </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">                                        </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                                 </span><span class="c1">// Mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                             </span><span class="c1">// Not diffusive</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;mobility&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table vs E/N&quot;</span><span class="p">,</span><span class="w">                      </span><span class="c1">// Specification of tabulated mobility lookup method</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;file&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bolsig_air.dat&quot;</span><span class="p">,</span><span class="w">                    </span><span class="c1">// File containg the mobility data</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;dump&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;debug_mobility.dat&quot;</span><span class="p">,</span><span class="w">                </span><span class="c1">// Optional argument for dumping table to disk (useful for debugging)</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;header&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E/N (Td)\tMobility *N (1/m/V/s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Line immediately preceding the colum data</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;E/N column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                             </span><span class="c1">// Column containing E/N</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;mu*N column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Column containing mu*N</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;min E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Minimum E/N kept when resampling table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;max E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2E6</span><span class="p">,</span><span class="w">                              </span><span class="c1">// Maximum E/N kept when resampling table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;points&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">                              </span><span class="c1">// Number of grid points kept when resampling the table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;spacing&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exponential&quot;</span><span class="p">,</span><span class="w">                    </span><span class="c1">// Grid point spacing when resampling the table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;E/N scale&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Optional argument for scaling mobility coefficient</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;mu*N scale&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                            </span><span class="c1">// Optional argument for scaling the E/N column</span>
</span><span class="hll"><span class="w">       </span><span class="p">}</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The parser for the diffusion coefficient is analogous; simply replace <code class="docutils literal notranslate"><span class="pre">mu*N</span></code> by <code class="docutils literal notranslate"><span class="pre">D*N</span></code>.</p>
</div>
</section>
</section>
<section id="temperature">
<h4>Temperature<a class="headerlink" href="#temperature" title="Permalink to this heading"></a></h4>
<p>The species temperature is only parametrically attached to the species (i.e., not solved for), and can be specified by the user.
Note that the temperature is mostly relevant for transport coefficients (e.g., reaction rates).
The temperature can be specified through the <code class="docutils literal notranslate"><span class="pre">temperature</span></code> field for each species, and various forms of specifying this is available.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If the specifies temperature is <em>not</em> specified by the user, it will be set equal to the background gas temperature.</p>
</div>
<section id="background-gas">
<h5>Background gas<a class="headerlink" href="#background-gas" title="Permalink to this heading"></a></h5>
<p>To set the temperature equal to the background gas temperature, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier field to <code class="docutils literal notranslate"><span class="pre">gas</span></code>.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2+&quot;</span><span class="p">,</span><span class="w">      </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">          </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Solver type.</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// Specify temperature</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gas&quot;</span><span class="w">  </span><span class="c1">// Temperature same as gas</span>
</span><span class="hll"><span class="w">       </span><span class="p">}</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id5">
<h5>Constant<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h5>
<p>To set a constant temperature, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">constant</span></code> and then specify the temperature.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2+&quot;</span><span class="p">,</span><span class="w">           </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">               </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">      </span><span class="c1">// Solver type.</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">       </span><span class="c1">// Specify temperature</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Constant temperature</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">        </span><span class="c1">// Temperature in Kelvin</span>
</span><span class="hll"><span class="w">       </span><span class="p">}</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id6">
<h5>Table vs <span class="math notranslate nohighlight">\(E/N\)</span><a class="headerlink" href="#id6" title="Permalink to this heading"></a></h5>
<p>To set the species temperature as a function <span class="math notranslate nohighlight">\(T = T\left(E/N\right)\)</span>, set the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier to <code class="docutils literal notranslate"><span class="pre">table</span> <span class="pre">vs</span> <span class="pre">E/N</span></code> and specify the following fields:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> For specifying the file containing the input data, which must be organized as column data <em>versus the mean energy</em>, e.g.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span># E/N   energy (eV)
0       1
100     2
200     3
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code> For specifying where in the file one starts reading data.
This is an optional argument intended for use with BOLSIG+ output data where the user specifies that the data is contained in the lines below the specified header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E/N</span> <span class="pre">column</span></code> For setting which column in the data file contains the values of <span class="math notranslate nohighlight">\(E/N\)</span> (optional, defaults to 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eV</span> <span class="pre">column</span></code> For setting which column in the data file contains the energy vs <span class="math notranslate nohighlight">\(E/N\)</span>.
This is an optional argument that defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E/N</span> <span class="pre">scale</span></code> Optional scaling of the column containing the <span class="math notranslate nohighlight">\(E/N\)</span> data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eV</span> <span class="pre">scale</span></code> Optional scaling of the column containing the energy (in eV).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">E/N</span></code> Optional truncation of the table representation of the data (applied after scaling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">points</span></code> Number of data points in internal table representation (optional, defaults to 1000).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> Spacing in internal table representation. Can be <code class="docutils literal notranslate"><span class="pre">linear</span></code> or <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.
This is an optional argument that defaults to <code class="docutils literal notranslate"><span class="pre">exponential</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dump</span></code> A string specifier for writing the table representation of <span class="math notranslate nohighlight">\(E/N, eV\)</span> to file.</p></li>
</ul>
<p>An example JSON specification that uses a BOLSIG+ output file for parsing the data for the mobility is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2+&quot;</span><span class="p">,</span><span class="w">                                </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                                    </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                           </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Not diffusive</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">                            </span><span class="c1">// Specification of temperature</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;table vs E/N&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Tabulated</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bolsig_air.dat&quot;</span><span class="p">,</span><span class="w">                </span><span class="c1">// File name</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;dump&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;debug_temperature.dat&quot;</span><span class="p">,</span><span class="w">         </span><span class="c1">// Dump to file</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;header&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E/N (Td)\tMean energy (eV)&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Header preceding data</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;E/N column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Column containing E/N</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;eV column&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                         </span><span class="c1">// Column containing the energy</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;min E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">                          </span><span class="c1">// Truncation of table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;max E/N&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2E6</span><span class="p">,</span><span class="w">                         </span><span class="c1">// Truncation of table</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;E/N scale&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Scaling of input data</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;eV scale&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                         </span><span class="c1">// Scaling of input data</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;spacing&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exponential&quot;</span><span class="p">,</span><span class="w">               </span><span class="c1">// Table spacing</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;points&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w">                          </span><span class="c1">// Number of points in table</span>
</span><span class="hll"><span class="w">       </span><span class="p">}</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="initial-particles">
<h4>Initial particles<a class="headerlink" href="#initial-particles" title="Permalink to this heading"></a></h4>
<p>Initial particles for species are added by including an <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">particles</span></code> field.
The field consists of an array of JSON entries, where each array entry represents various ways of adding particles.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">particles</span></code> field is <em>incrementing</em>, each new entry will add additional particles.</p>
</div>
<p>For example, to add two particles with particle weights of 1, one may specify</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                   </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">          </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="c1">// Not diffusive</span>
<span class="hll"><span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">     </span><span class="c1">// Initial particles</span>
</span><span class="hll"><span class="w">          </span><span class="p">{</span>
</span><span class="hll"><span class="w">             </span><span class="nt">&quot;single particle&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Single physical particle at (0,0,0)</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="hll"><span class="w">          </span><span class="p">},</span>
</span><span class="hll"><span class="w">          </span><span class="p">{</span>
</span><span class="hll"><span class="w">             </span><span class="nt">&quot;single particle&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Single physical particle at (0,1,0)</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="hll"><span class="w">          </span><span class="p">}</span>
</span><span class="hll"><span class="w">       </span><span class="p">]</span>
</span><span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<p>The various supported ways of additional initial particles are discussed below.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If a solver is specified as a CDR solver, the initial particles are deposited as densities on the mesh using an NGP scheme.</p>
</div>
<section id="single-particle">
<h5>Single particle<a class="headerlink" href="#single-particle" title="Permalink to this heading"></a></h5>
<p>Single particles are placed by including a <code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">particle</span></code> JSON entry.
The user must specify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code> The particle position.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> The particle weight.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                   </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">          </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">       </span><span class="c1">// Not diffusive</span>
<span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">     </span><span class="c1">// Initial particles</span>
<span class="w">          </span><span class="p">{</span>
<span class="hll"><span class="w">             </span><span class="nt">&quot;single particle&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Single physical particle at (0,0,0)</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;position&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="uniform-distribution">
<h5>Uniform distribution<a class="headerlink" href="#uniform-distribution" title="Permalink to this heading"></a></h5>
<p>Particles can be randomly drawn from a uniform distribution (a rectangular box in 2D/3D) by including a <code class="docutils literal notranslate"><span class="pre">uniform</span> <span class="pre">distribution</span></code>.
The user must specify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">low</span> <span class="pre">corner</span></code> The lower left corner of the box.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high</span> <span class="pre">corner</span></code> The lower left corner of the box.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">particles</span></code> Number of computational particles that are drawn.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> Particle weights.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                                  </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                                    </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                           </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                           </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Not diffusive</span>
<span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="c1">// Initial particles</span>
<span class="w">          </span><span class="p">{</span>
<span class="hll"><span class="w">             </span><span class="nt">&quot;uniform distribution&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">            </span><span class="c1">// Particles inside a box</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;low corner&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">-0.04</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">],</span><span class="w">    </span><span class="c1">// Lower-left physical corner of sampling region</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;high corner&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">0.04</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="c1">// Upper-right physical corner of sampling region</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;num particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">             </span><span class="c1">// Number of computational particles</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                       </span><span class="c1">// Particle weights</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="sphere-distribution">
<h5>Sphere distribution<a class="headerlink" href="#sphere-distribution" title="Permalink to this heading"></a></h5>
<p>Particles can be randomly drawn inside a circle (sphere in 3D)  by including a <code class="docutils literal notranslate"><span class="pre">sphere</span> <span class="pre">distribution</span></code>.
The user must specify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code> The sphere center.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radius</span></code> The sphere radius.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">particles</span></code> Number of computational particles that are drawn.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> Particle weights.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                              </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Not diffusive</span>
<span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                </span><span class="c1">// Initial particles</span>
<span class="w">          </span><span class="p">{</span>
<span class="hll"><span class="w">             </span><span class="nt">&quot;sphere distribution&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">       </span><span class="c1">// Particles inside sphere</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;center&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">7.5E-3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="c1">// Sphere center</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;radius&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1E-3</span><span class="p">,</span><span class="w">             </span><span class="c1">// Sphere radius</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;num particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">       </span><span class="c1">// Number of computational particles</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                 </span><span class="c1">// Particle weights</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="gaussian-distribution">
<h5>Gaussian distribution<a class="headerlink" href="#gaussian-distribution" title="Permalink to this heading"></a></h5>
<p>Particles can be randomly drawn from a Gaussian distribution by including a <code class="docutils literal notranslate"><span class="pre">gaussian</span> <span class="pre">distribution</span></code>.
The user must specify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code> The sphere center.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radius</span></code> The sphere radius.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span> <span class="pre">particles</span></code> Number of computational particles that are drawn.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> Particle weights.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                              </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Not diffusive</span>
<span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                </span><span class="c1">// Initial particles</span>
<span class="w">          </span><span class="p">{</span>
<span class="hll"><span class="w">             </span><span class="nt">&quot;gaussian distribution&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">     </span><span class="c1">// Particles drawn from a gaussian</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;center&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">7.5E-3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="c1">// Center</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;radius&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1E-3</span><span class="p">,</span><span class="w">             </span><span class="c1">// Radius</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;num particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">       </span><span class="c1">// Number of computational particles</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;weight&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">                 </span><span class="c1">// Particle weights</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="list-file">
<h5>List/file<a class="headerlink" href="#list-file" title="Permalink to this heading"></a></h5>
<p>Particles can be read from a file by including a <code class="docutils literal notranslate"><span class="pre">list</span></code> specifier.
The particles must be organized as rows containing the coordinate positions and weights, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x   y   z    w</span>
  <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span>    <span class="mi">1</span>
</pre></div>
</div>
<p>The user must specify</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> File name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> Column containing the <span class="math notranslate nohighlight">\(x\)</span> coordinates (optional, defaults to 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> Column containing the <span class="math notranslate nohighlight">\(y\)</span> coordinates (optional, defaults to 1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> Column containing the <span class="math notranslate nohighlight">\(z\)</span> coordinates (optional, defaults to 2).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">w</span></code> Column containing the particle weight (optional, defaults to 3).</p></li>
</ul>
<p>For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">&quot;plasma species&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                            </span><span class="c1">// Species ID</span>
<span class="w">       </span><span class="nt">&quot;Z&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                              </span><span class="c1">// Charge number</span>
<span class="w">       </span><span class="nt">&quot;solver&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ito&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Solver type.</span>
<span class="w">       </span><span class="nt">&quot;mobile&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Not mobile</span>
<span class="w">       </span><span class="nt">&quot;diffusive&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Not diffusive</span>
<span class="w">       </span><span class="nt">&quot;initial particles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                </span><span class="c1">// Initial particles</span>
<span class="w">          </span><span class="p">{</span>
<span class="hll"><span class="w">             </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initial_particles.dat&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// File containing the particles</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;x column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;y column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;z column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span class="hll"><span class="w">                </span><span class="nt">&quot;w column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
</span><span class="hll"><span class="w">             </span><span class="p">}</span>
</span><span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="photon-species">
<h3>Photon species<a class="headerlink" href="#photon-species" title="Permalink to this heading"></a></h3>
<p>Photon species are species that are tracked using a radiative transfer solver.
These are defined by an array of entries in a <code class="docutils literal notranslate"><span class="pre">photon</span> <span class="pre">species</span></code> JSON entry, and must define the following information:</p>
<ul class="simple">
<li><p>An ID/name for the species.</p></li>
<li><p>The absorption coefficient for the photon type.</p></li>
</ul>
<section id="id7">
<h4>Basic definition<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h4>
<p>A basic definition of a single photon species is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photon species&quot;</span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="w">              </span><span class="c1">// Photon species id. Must be unique</span>
<span class="w">         </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">              </span><span class="c1">// Specification of absorption coefficient.</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Specify constant absorption coefficient</span>
<span class="w">             </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E4</span><span class="w">        </span><span class="c1">// Value of the absorption coefficeint</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<p>Multiple photon species are added by appending with more entries, e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photon species&quot;</span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y1&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Photon species id. Must be unique</span>
<span class="w">         </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">              </span><span class="c1">// Specification of absorption coefficient.</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Specify constant absorption coefficient</span>
<span class="w">             </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E4</span><span class="w">        </span><span class="c1">// Value of the absorption coefficeint</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">},</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y2&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Photon species id. Must be unique</span>
<span class="w">         </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">              </span><span class="c1">// Specification of absorption coefficient.</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Specify constant absorption coefficient</span>
<span class="w">             </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E4</span><span class="w">        </span><span class="c1">// Value of the absorption coefficeint</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="absorption-coefficient">
<h4>Absorption coefficient<a class="headerlink" href="#absorption-coefficient" title="Permalink to this heading"></a></h4>
<section id="id8">
<h5>Constant<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h5>
<p>In order to set a constant absorption coefficient, set <code class="docutils literal notranslate"><span class="pre">type</span></code> to constant and then specify the <code class="docutils literal notranslate"><span class="pre">value</span></code> field.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photon species&quot;</span><span class="p">:</span>
<span class="w"> </span><span class="p">[</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E4</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="stochastic-a">
<h5>stochastic A<a class="headerlink" href="#stochastic-a" title="Permalink to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">stochastic</span> <span class="pre">A</span></code> specifier computes a random absorption length from the expression</p>
<div class="math notranslate nohighlight">
\[\kappa = \left(\chi_{\textrm{min}}p_i\right)\left(\frac{\chi_{\textrm{max}}}{\chi_{\textrm{min}}}\right)^{\frac{f-f_1}{f_2 - f_1}},\]</div>
<p>where <span class="math notranslate nohighlight">\(p_i\)</span> is the partial pressure of some species <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(p_i\chi_{\textrm{min}}\)</span> and <span class="math notranslate nohighlight">\(p_i\chi_{\textrm{max}}\)</span> are minimum and maximum absorption lengths on the frequency interval <span class="math notranslate nohighlight">\(f\in[f_1,f_2]\)</span>.
The user must specify <span class="math notranslate nohighlight">\(\chi_{\textrm{min}}\)</span>, <span class="math notranslate nohighlight">\(\chi_{\textrm{max}}\)</span>, <span class="math notranslate nohighlight">\(f_1\)</span>, <span class="math notranslate nohighlight">\(f_2\)</span>, and the background species used when computing <span class="math notranslate nohighlight">\(p_i\)</span>.
This is done through fields <code class="docutils literal notranslate"><span class="pre">f1</span></code>, <code class="docutils literal notranslate"><span class="pre">f_2</span></code>, <code class="docutils literal notranslate"><span class="pre">chi</span> <span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">chi</span> <span class="pre">max</span></code>, and <code class="docutils literal notranslate"><span class="pre">neutral</span></code>.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photon species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stochastic A&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;f1&quot;</span><span class="p">:</span><span class="w">   </span><span class="mf">2.925E15</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;f2&quot;</span><span class="p">:</span><span class="w">   </span><span class="mf">3.059E15</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;chi min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.625E-2</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;chi max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;neutral&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="stochastic-b">
<h5>stochastic B<a class="headerlink" href="#stochastic-b" title="Permalink to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">stochastic</span> <span class="pre">B</span></code> specifier computes a random absorption length from the expression</p>
<div class="math notranslate nohighlight">
\[\kappa = \left(\chi_{\textrm{min}}p_i\right)\left(\frac{\chi_{\textrm{max}}}{\chi_{\textrm{min}}}\right)^u,\]</div>
<p>where <span class="math notranslate nohighlight">\(p_i\)</span> is the partial pressure of some species <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(p_i\chi_{\textrm{min}}\)</span> and <span class="math notranslate nohighlight">\(p_i\chi_{\textrm{max}}\)</span> are minimum and maximum absorption lengths, and <span class="math notranslate nohighlight">\(u\)</span> is a random number between 0 and 1.
Note that that this is just a simpler way of using the <code class="docutils literal notranslate"><span class="pre">stochastic</span> <span class="pre">A</span></code> specifier above.
The user must specify <span class="math notranslate nohighlight">\(\chi_{\textrm{min}}\)</span>, <span class="math notranslate nohighlight">\(\chi_{\textrm{max}}\)</span>, and the background species used when computing <span class="math notranslate nohighlight">\(p_i\)</span>.
This is done through fields <code class="docutils literal notranslate"><span class="pre">chi</span> <span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">chi</span> <span class="pre">max</span></code>, and <code class="docutils literal notranslate"><span class="pre">neutral</span></code>.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photon species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;kappa&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stochastic B&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;chi min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.625E-2</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;chi max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;neutral&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id9">
<h3>Plasma reactions<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<p>Plasma reactions are always specified stoichiometrically in the form <span class="math notranslate nohighlight">\(S_A + S_B + \ldots \xrightarrow{k} S_C + S_D + \ldots\)</span>.
The user must supply the following information:</p>
<ul class="simple">
<li><p>Species involved on the left-hand and right-hand side of the reaction.</p></li>
<li><p>How to compute the reaction rate.</p></li>
<li><p>Optionally specify gradient corrections to the reaction.</p></li>
<li><p>Optionally specify whether or not the reaction rate will be written to file.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The JSON interface expects that the reaction rate <span class="math notranslate nohighlight">\(k\)</span> is the same as in the reaction rate equation.
Internally, the rate is converted to a format that is consistent with the KMC algorithm.</p>
</div>
<p>Plasma reactions should be entered in the JSON file using an array (the order of reactions does not matter).</p>
<details>
<summary><a>Basic reaction example specifiers</a></summary><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// First reaction goes here,</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">   </span><span class="c1">// Next reaction goes here,</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</details><br><section id="reaction-specifiers">
<h4>Reaction specifiers<a class="headerlink" href="#reaction-specifiers" title="Permalink to this heading"></a></h4>
<p>Each reaction must include an entry <code class="docutils literal notranslate"><span class="pre">reaction</span></code> in the list of reactions.
This entry must consist of a single string with a left-hand and right-hand sides separated by <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code>.
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e + N2 -&gt; e + e + N2+&quot;</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>which is equivalent to the reaction <span class="math notranslate nohighlight">\(\text{e} + \text{N}_2 \rightarrow \text{e} + \text{e} + \text{N}_2^+\)</span>.
Each species must be separated by whitespace and a addition operator.
For example, the specification <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">+</span> <span class="pre">B</span> <span class="pre">+</span> <span class="pre">C</span></code> will be interpreted as a reaction <span class="math notranslate nohighlight">\(\text{A} + \text{B} + \text{C}\)</span> but the specification <code class="docutils literal notranslate"><span class="pre">A+B</span> <span class="pre">+</span> <span class="pre">C</span></code> will be interpreted as a reaction between one species <code class="docutils literal notranslate"><span class="pre">A+B</span></code> and another species <code class="docutils literal notranslate"><span class="pre">C</span></code> .</p>
<p>Internally, both the left- and right-hand sides are checked against background and plasma species.
The program will perform a run-time exit if the species are not defined in these lists.
Note that the right-hand side can additonal contain photon species.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Products not not defined as a species can be enclosed by parenthesis <code class="docutils literal notranslate"><span class="pre">(</span></code> and <code class="docutils literal notranslate"><span class="pre">)</span></code>.</p>
</div>
<p>The reaction string generally expects all species on each side of the reaction to be defined.
It is, however, occasionally useful to include products which are <em>not</em> defined.
For example, one may with to include the reaction <span class="math notranslate nohighlight">\(\text{e} + \text{O}_2^+ \rightarrow \text{O} +\text{O}\)</span> but not actually track the species <span class="math notranslate nohighlight">\(\text{O}\)</span>.
The reaction string can then be defined as the string <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">+</span> <span class="pre">O2+</span> <span class="pre">-&gt;</span></code> but as it might be difficult for users to actually remember the full reaction, we may also enter it as <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">+</span> <span class="pre">O2+</span> <span class="pre">-&gt;</span> <span class="pre">(O)</span> <span class="pre">+</span> <span class="pre">(O)</span></code>.</p>
</section>
<section id="rate-calculation">
<h4>Rate calculation<a class="headerlink" href="#rate-calculation" title="Permalink to this heading"></a></h4>
<p>Reaction rates can be specified using multiple formats (constant, tabulated, function-based, etc).
To specify how the rate is computed, one must specify the <code class="docutils literal notranslate"><span class="pre">type</span></code> keyword in the JSON entry.</p>
<section id="id10">
<h5>Constant<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h5>
<p>To use a constant reaction rate, the <code class="docutils literal notranslate"><span class="pre">type</span></code> specifier must be set to constant and the reaction rate must be specified through the <code class="docutils literal notranslate"><span class="pre">value</span></code> keyword.
A JSON specification is e.g.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;e + N2 -&gt; e + e + N2+&quot;</span><span class="w"> </span><span class="c1">// Specify reaction</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Reaction rate is constant</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.E-30</span><span class="w">                     </span><span class="c1">// Reaction rate</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="function-vs-e-n">
<h5>Function vs E/N<a class="headerlink" href="#function-vs-e-n" title="Permalink to this heading"></a></h5>
<p>Some rates given as a function <span class="math notranslate nohighlight">\(k = k\left(E/N\right)\)</span> are supported, which are outlined below.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In the below function-based rates, <span class="math notranslate nohighlight">\(E/N\)</span> indicates the electric field in units of Townsend.</p>
</div>
<p><strong>function E/N exp A</strong></p>
<p>This specification is equivalent to a fluid rate</p>
<div class="math notranslate nohighlight">
\[k = c_1\exp\left[-\left(\frac{c_2}{c_3 + c_4 E/N}\right)^{c_5}\right].\]</div>
<p>The user must specify the constants <span class="math notranslate nohighlight">\(c_i\)</span> in the JSON file.
An example specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;A + B -&gt; &quot;</span><span class="w">       </span><span class="c1">// Example reaction string.</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function E/N exp A&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Function based rate.</span>
<span class="w">      </span><span class="nt">&quot;c1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                    </span><span class="c1">// c1-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c2&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                    </span><span class="c1">// c2-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c3&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                    </span><span class="c1">// c3-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c4&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                    </span><span class="c1">// c4-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c5&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                     </span><span class="c1">// c5-coefficient</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="temperature-dependent">
<h5>Temperature-dependent<a class="headerlink" href="#temperature-dependent" title="Permalink to this heading"></a></h5>
<p>Some rates can be given as functions <span class="math notranslate nohighlight">\(k = k(T)\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is some temperature.</p>
<p><strong>function T A</strong></p>
<p>This specification is equivalent to a fluid rate</p>
<div class="math notranslate nohighlight">
\[k = c_1\left(T_i\right)^{c_2}.\]</div>
<p>Mandatory input variables are <span class="math notranslate nohighlight">\(c_1, c_2\)</span>, and the specification of the species corresponding to <span class="math notranslate nohighlight">\(T_i\)</span>.
This can correspond to one of the background species.
An example specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;A + B -&gt; &quot;</span><span class="w"> </span><span class="c1">// Example reaction string.</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function T A&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Function based rate.</span>
<span class="w">      </span><span class="nt">&quot;c1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">              </span><span class="c1">// c1-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c2&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">              </span><span class="c1">// c2-coefficient</span>
<span class="w">      </span><span class="nt">&quot;T&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w">               </span><span class="c1">// Which species temperature</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p><strong>function T1T2 A</strong></p>
<p>This specification is equivalent to a fluid rate</p>
<div class="math notranslate nohighlight">
\[k = c_1\left(\frac{T_1}{T_2}\right)^{c_2}.\]</div>
<p>Mandatory input variables are <span class="math notranslate nohighlight">\(c_1, c_2\)</span>, and the specification of the species corresponding to <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span>.
This can correspond to one of the background species.
An example specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;A + B -&gt; &quot;</span><span class="w">    </span><span class="c1">// Example reaction string.</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function T1T2 A&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Function based rate.</span>
<span class="w">      </span><span class="nt">&quot;c1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                 </span><span class="c1">// c1-coefficient</span>
<span class="w">      </span><span class="nt">&quot;c2&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">                 </span><span class="c1">// c2-coefficient</span>
<span class="w">      </span><span class="nt">&quot;T1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w">                 </span><span class="c1">// Which species temperature for T1</span>
<span class="w">      </span><span class="nt">&quot;T2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="w">                  </span><span class="c1">// Which species temperature for T2</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="townsend-rates">
<h5>Townsend rates<a class="headerlink" href="#townsend-rates" title="Permalink to this heading"></a></h5>
<p>Reaction rates can be specified to be proportional to <span class="math notranslate nohighlight">\(\alpha\left|\mathbf{v}_i\right|\)</span> where <span class="math notranslate nohighlight">\(\alpha\)</span> is the Townsend ionization coefficient and <span class="math notranslate nohighlight">\(\left|\mathbf{v}_i\right|\)</span> is the drift velocity for some species <span class="math notranslate nohighlight">\(i\)</span>.
This type of reaction is normally encountered when using simplified chemistry, e.g.</p>
<div class="math notranslate nohighlight">
\[\partial_t n_i = \alpha\left|\mathbf{v}_s\right| n_i = \alpha\mu\left|E\right|n_i.\]</div>
<p>which is representative of the reaction <span class="math notranslate nohighlight">\(S_i \rightarrow S_i + S_i\)</span>.
To specify a Townsend rate constant, one can use the following:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha*v</span></code> for setting the rate constant proportional to the Townsend ionization rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eta*v</span></code> for setting the rate constant proportional to the Townsend attachment rate.</p></li>
</ol>
<p>One must also specify which species is associated with <span class="math notranslate nohighlight">\(\left|\mathbf{v}\right|\)</span> by specifying a species flag.
A complete JSON specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="w">      </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Rate is alpha*v</span>
<span class="w">            </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="w">                 </span><span class="c1">// Species for v</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using the Townsend coefficients for computing the rates, one should normally <em>not</em> include any neutrals on the left hand side of the reaction.
The reason for this is that the Townsend coefficients <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> already incorporate the neutral density.
By specifying e.g. a reaction string <span class="math notranslate nohighlight">\(\text{e} + \text{N}_2 \rightarrow \text{e} + \text{e} + \text{N}_2^+\)</span> together with the <code class="docutils literal notranslate"><span class="pre">alpha*v</span></code> or <code class="docutils literal notranslate"><span class="pre">eta*v</span></code> specifiers, one will end up multiplying in the neutral density twice, which will lead to an incorrect rate.</p>
</div>
</section>
<section id="id11">
<h5>Tabulated vs E/N<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h5>
</section>
</section>
<section id="scaling">
<h4>Scaling<a class="headerlink" href="#scaling" title="Permalink to this heading"></a></h4>
<p>Reactions can be scaled by including a <code class="docutils literal notranslate"><span class="pre">scale</span></code> field in the JSON entry.
This will scale the reaction coefficient by the input factor, e.g. modify the rate constant as</p>
<div class="math notranslate nohighlight">
\[k \rightarrow \nu k,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is the scaling factor.
This is useful when scaling reactions from different units, or for completely turning off some input reactions.
An example JSON specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;scale&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="w">                   </span><span class="c1">// Scaling factor</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If one turns off a reaction by setting <code class="docutils literal notranslate"><span class="pre">scale</span></code> to zero, the KMC algorithm will still use the reaction but no reactants/products are consumed/produced.</p>
</div>
</section>
<section id="efficiency">
<h4>Efficiency<a class="headerlink" href="#efficiency" title="Permalink to this heading"></a></h4>
<p>Reactions efficiencies can be modified in the same way as one do with the <code class="docutils literal notranslate"><span class="pre">scale</span></code> field, e.g. modify the rate constant as</p>
<div class="math notranslate nohighlight">
\[k \rightarrow \nu k,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is the reaction efficiency.
Specifications of the efficiency can be achieved in the forms discussed below.</p>
<section id="constant-efficiency">
<h5>Constant efficiency<a class="headerlink" href="#constant-efficiency" title="Permalink to this heading"></a></h5>
<p>An example JSON specification for a constant efficiency is:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="efficiency-vs-e-n">
<h5>Efficiency vs E/N<a class="headerlink" href="#efficiency-vs-e-n" title="Permalink to this heading"></a></h5>
<p>An example JSON specification for an efficiency computed versus <span class="math notranslate nohighlight">\(E/N\)</span> is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;efficiency vs E/N&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;efficiencies.dat&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where the file <code class="docutils literal notranslate"><span class="pre">efficiencies.dat</span></code> must contain two-column data containing values of <span class="math notranslate nohighlight">\(E/N\)</span> along the first column and efficiencies along the second column.
An example file is e.g.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>0    0
100  0.1
200  0.3
500  0.8
1000 1.0
</pre></div>
</div>
<p>This data is then internally convered to a uniformly spaced lookup table (see <span class="xref std std-ref">LookupTable</span>).</p>
</section>
<section id="efficiency-vs-e">
<h5>Efficiency vs E<a class="headerlink" href="#efficiency-vs-e" title="Permalink to this heading"></a></h5>
<p>An example JSON specification for an efficiency computed versus <span class="math notranslate nohighlight">\(E\)</span> is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;efficiency vs E&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;efficiencies.dat&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where the file <code class="docutils literal notranslate"><span class="pre">efficiencies.dat</span></code> must contain two-column data containing values of <span class="math notranslate nohighlight">\(E\)</span> along the first column and efficiencies along the second column.
This method follows the same as <code class="docutils literal notranslate"><span class="pre">efficiency</span> <span class="pre">vs</span> <span class="pre">E/N</span></code> where the data in the input file is put in a lookup table.</p>
</section>
</section>
<section id="quenching">
<h4>Quenching<a class="headerlink" href="#quenching" title="Permalink to this heading"></a></h4>
<p>Reaction quenching can be achieved in the following forms:</p>
<section id="pressure-based">
<h5>Pressure-based<a class="headerlink" href="#pressure-based" title="Permalink to this heading"></a></h5>
<p>The reaction rate can modified by a factor <span class="math notranslate nohighlight">\(p_q/\left[p_q + p\left(\mathbf{x}\right)\right]\)</span> where <span class="math notranslate nohighlight">\(p_q\)</span> is a quenching pressure and <span class="math notranslate nohighlight">\(p\left(\mathbf{x}\right)\)</span> is the gas pressure.
This will modify the rate as</p>
<div class="math notranslate nohighlight">
\[k \rightarrow k\frac{p_q}{p_q + p\left(\mathbf{x}\right)}.\]</div>
<p>An example JSON specification is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e + N2 -&gt; e + N2 + Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;quenching pressure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4000.0</span><span class="w">        </span><span class="c1">// Quenching pressure</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The quenching pressure must be specified in units of Pascal.</p>
</div>
</section>
<section id="rate-based">
<h5>Rate-based<a class="headerlink" href="#rate-based" title="Permalink to this heading"></a></h5>
<p>The reaction rate can be modified by a factor <span class="math notranslate nohighlight">\(k_r/\left[k_r + k_p + k_q\right]\)</span>.
The intention behind this scaling is that reaction <span class="math notranslate nohighlight">\(r\)</span> occurs only if it is not predissociated (by rate <span class="math notranslate nohighlight">\(k_p\)</span>) or quenched (by rate <span class="math notranslate nohighlight">\(k_q\)</span>).
Such processes can occur, for example, in excited molecules.
This will modifiy the rate constant as</p>
<div class="math notranslate nohighlight">
\[k \rightarrow k\frac{k_r}{k_r + k_p + k_q},\]</div>
<p>where the user will specifiy <span class="math notranslate nohighlight">\(k_r\)</span>, <span class="math notranslate nohighlight">\(k_p\)</span>, and <span class="math notranslate nohighlight">\(k_q/N\)</span>.
The JSON specification must contain <code class="docutils literal notranslate"><span class="pre">quenching</span> <span class="pre">rates</span></code>, for example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e + N2 -&gt; e + N2 + Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;quenching rates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">                </span><span class="c1">// Specify relevant rates</span>
<span class="w">           </span><span class="nt">&quot;kr&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E9</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;kp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1E9</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;kq/N&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="gradient-correction">
<h4>Gradient correction<a class="headerlink" href="#gradient-correction" title="Permalink to this heading"></a></h4>
<p>In LFA-based models it is frequently convenient to include energy-corrections to the ionization rate.
In this case one modifies the rate as</p>
<div class="math notranslate nohighlight">
\[k \rightarrow k\left(1 + \frac{\mathbf{E}\cdot \left(D\nabla n_i\right)}{n_i\mu_iE^2}\right).\]</div>
<p>To include this correction one may include a specifier <code class="docutils literal notranslate"><span class="pre">gradient</span> <span class="pre">correction</span></code> in the JSON entry, in which case one must also enter the species <span class="math notranslate nohighlight">\(n_i\)</span>.
A JSON specification that includes this</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;gradient correction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="w">     </span><span class="c1">// Specify gradient correction using species &quot;e&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This is equivalent to a source term</p>
<div class="math notranslate nohighlight">
\[\begin{split}S &amp;= \alpha n_e\left|\mathbf{v}_e\right|\left(1 + \frac{\mathbf{E}\cdot \left(D_e\nabla n_e\right)}{n_e\mu_eE^2}\right) \\
&amp;=\alpha\left[n_e\left|\mathbf{v}_e\right| + \hat{\mathbf{E}}\cdot\left(D_e\nabla n_e\right)\right].\end{split}\]</div>
<p>One can recognize this term as a regular electron impact ionization source term (typically written as <span class="math notranslate nohighlight">\(\alpha \mu n_e E\)</span>).
With the gradient correction, the ionization source term is essentially computed using the full electron flux, i.e., including the diffusive electron flux.
Note that the full electron flux has a preferential direction, and the physical interpretation of this direction is that if there is net diffusion against the electric field, electrons lose energy and the impact ionization source term is correspondingly lower.</p>
</section>
<section id="understanding-reaction-rates">
<h4>Understanding reaction rates<a class="headerlink" href="#understanding-reaction-rates" title="Permalink to this heading"></a></h4>
<p>The JSON specification takes <em>fluid rates</em> as input to the KMC algorithm.
Note that subsequent application of multiple scaling factors are multiplicative.
For example, the specification</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">             </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;gradient correction&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;e&quot;</span><span class="w">     </span><span class="c1">// Specify gradient correction using species &quot;e&quot;</span>
<span class="w">        </span><span class="nt">&quot;quenching pressure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4000</span><span class="p">,</span><span class="w">    </span><span class="c1">// Quenching pressure</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="w">              </span><span class="c1">// Reaction efficiency</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>is equivalent to the rate constant</p>
<div class="math notranslate nohighlight">
\[k = \alpha\left|\mathbf{v}_e\right|\left(1 + \frac{\mathbf{E}\cdot \left(D_e\nabla n_e\right)}{n_e\mu_eE^2}\right)\frac{p_q}{p_q+p\left(\mathbf{x}\right)}\nu\]</div>
<p>Internally, conversions between the <em>fluid rate</em> <span class="math notranslate nohighlight">\(k\)</span> and the KMC rate <span class="math notranslate nohighlight">\(c\)</span> are made.
The conversion factors depend on the reaction order, and ensure consistency between the KMC and fluid formulations.</p>
</section>
<section id="plotting-rates">
<h4>Plotting rates<a class="headerlink" href="#plotting-rates" title="Permalink to this heading"></a></h4>
<p>Reaction rates can be plotted by including an optional <code class="docutils literal notranslate"><span class="pre">plot</span></code> specifier.
If the specifier included, the reaction rates will be included in the HDF5 output.
The user can also include a description string which will be used when plotting the reaction.</p>
<p>The following two specifiers can be included:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot</span></code> (true/false) for plotting the reaction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> (string) for naming the reaction in the HDF5 output.</p></li>
</ul>
<p>If the plot description is left out, the reaction string will be used as a variable name in the plot file.
A JSON specification that includes these</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e -&gt; e + e + M+&quot;</span><span class="p">,</span><span class="w">       </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">                   </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                      </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;plot&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                        </span><span class="c1">// Plot this reaction</span>
<span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Townsend ionization&quot;</span><span class="w"> </span><span class="c1">// Variable name in HDF5</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="printing-rates">
<h4>Printing rates<a class="headerlink" href="#printing-rates" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">ItoKMCJSON</span></code> can print the plasma reaction rates (including photon-generating ones) to file.
This is done through an optional input argument <code class="docutils literal notranslate"><span class="pre">print_rates</span></code> in the input file (not the JSON specification).
The following options are supported:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ItoKMCJSON.print_rates            = true
ItoKMCJSON.print_rates_minEN      = 1
ItoKMCJSON.print_rates_maxEN      = 1000
ItoKMCJSON.print_rates_num_points = 200
ItoKMCJSON.print_rates_spacing    = exponential
ItoKMCJSON.print_rates_filename   = fluid_rates.dat
ItoKMCJSON.print_rates_pos        = 0 0 0
</pre></div>
</div>
<p>Setting <code class="docutils literal notranslate"><span class="pre">ItoKMCJSON.print_rates</span></code> to true in the input file will write all reaction rates as column data <span class="math notranslate nohighlight">\(E/N, k(E/N)\)</span>.
Here, <span class="math notranslate nohighlight">\(k\)</span> indicates the <em>fluid rate</em>, so for a reaction <span class="math notranslate nohighlight">\(A + B + C \xrightarrow{k}\ldots\)</span> it will include the rate <span class="math notranslate nohighlight">\(k\)</span>.
Reactions are ordered identical to the order of the reactions in the JSON specification.
This feature is mostly used for debugging or development efforts.</p>
</section>
</section>
<section id="id12">
<h3>Particle placement<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<p>Specification of secondary particle placement is done through the JSON file by specifying the <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">placement</span></code> field.
Currently, new particles may be placed on the centroid, uniformly distributed in the grid cell, or placed randomly in the downstream region of some user-defined species.
The method is specified through the <code class="docutils literal notranslate"><span class="pre">method</span></code> specifier, which must either be <code class="docutils literal notranslate"><span class="pre">centroid</span></code>, <code class="docutils literal notranslate"><span class="pre">random</span></code>, or <code class="docutils literal notranslate"><span class="pre">downstream</span></code>.
If specifying <code class="docutils literal notranslate"><span class="pre">downstream</span></code>, one must also include a species specifier (which must correspond to one of the plasma species).
The following three specifies are all valid:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;particle placement&quot;</span><span class="p">:</span>
<span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;centroid&quot;</span>
<span class="p">}</span>

<span class="nt">&quot;particle placement&quot;</span><span class="p">:</span>
<span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;random&quot;</span>
<span class="p">}</span>

<span class="nt">&quot;particle placement&quot;</span><span class="p">:</span>
<span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;downstream&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>Photoionization<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<p>Photoionization reactions are specified by including a <code class="docutils literal notranslate"><span class="pre">photoionization</span></code> array of JSON entries that specify each reaction.
The left-hand side of the reaction must contain a photon species (plasma and background species can be present but will be ignored), and the right-hand side can consist of any species except other photon species.
Each entry <em>must</em> contain a reaction string specifier and optionally also an efficiency (which defaults to 1).
Assume that photons are generated through the reaction</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e + N2 -&gt; e + N2 + Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;quenching pressure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4000.0</span><span class="w">        </span><span class="c1">// Quenching</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6</span><span class="w">                   </span><span class="c1">// Excitation events per ionization event</span>
<span class="w">        </span><span class="nt">&quot;scale&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                        </span><span class="c1">// Photoionization events per absorbed photon</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where we assume an excitation efficiency of <span class="math notranslate nohighlight">\(0.6\)</span> and photoionization efficiency of <span class="math notranslate nohighlight">\(0.1\)</span>.
An example photoionization specification is then</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;photoionization&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y + O2 -&gt; e + O2+&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note that the efficiency of this reaction is 1, i.e. the photoionization probabilities was pre-evaluated.
As discussed in <a class="reference internal" href="#chap-itokmcphysics"><span class="std std-ref">ItoKMCPhysics</span></a>, we can perform late evaluation of the photoionization probability by specifically including a efficiency.
In this case we modify the above into</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;plasma reactions&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e + N2 -&gt; e + N2 + Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Reaction string</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alpha*v&quot;</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Rate is alpha*v</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w">                     </span><span class="c1">// Species for v,</span>
<span class="w">        </span><span class="nt">&quot;quenching pressure&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">4000.0</span><span class="w">        </span><span class="c1">// Quenching</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6</span><span class="w">                   </span><span class="c1">// Excitation events per ionization event</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
<span class="nt">&quot;photoionization&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y + O2 -&gt; e + O2+&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y + O2 -&gt; (null)&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where a null-absorption model has been added for the photon absorption.
When multiple pathways are specified this way, and they have probabilities <span class="math notranslate nohighlight">\(\xi_1, \xi_2, \ldots\)</span>, the reaction is stochastically determined from a discrete distribution with relative probabilities <span class="math notranslate nohighlight">\(p_i = \xi_i/(\xi_1 + \xi_2+\ldots)\)</span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The null-reaction model is <em>not</em> automatically added when using late evaluation of the photoionization probability.</p>
</div>
</section>
<section id="secondary-emission">
<h3>Secondary emission<a class="headerlink" href="#secondary-emission" title="Permalink to this heading"></a></h3>
<p>Secondary emission is supported for particles, including photons, but not for fluid species.
Specification of secondary emission is done separately on dielectrics and electrodes by specifying JSON entries <code class="docutils literal notranslate"><span class="pre">electrode</span> <span class="pre">emission</span></code> and <code class="docutils literal notranslate"><span class="pre">dielectric</span> <span class="pre">emission</span></code>.
The internal specification for these are identical, so all examples below use <code class="docutils literal notranslate"><span class="pre">dielectric</span> <span class="pre">emission</span></code>.
Secondary emission reactions are specified similarly to photoionization reactions.
However, the left-hand side must consist of a single species (photon or particle), while the right-hand side can consist of multiple species.
Wildcards <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> are supported, as is the <code class="docutils literal notranslate"><span class="pre">(null)</span></code> species which enables null-reactions, as further discussed below.
An example JSON specification that enables secondary electron emission due to photons and ion impact is</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;dielectric emission&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y -&gt; e&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y -&gt; (null)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;efficiency&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">reaction</span></code> field specifies which reaction is triggered: The left hand side is the primary (outgoing) species and the left hand side must contain the secondary emissions.
The left-hand side can consist of either photons (e.g., <code class="docutils literal notranslate"><span class="pre">Y</span></code>) or particle (e.g., <code class="docutils literal notranslate"><span class="pre">O2+</span></code>) species.
The efficiency field specifies the efficiency of the reaction.
When multiple reactions are specified, we randomly sample the reaction according to a discrete distribution with probabilities</p>
<div class="math notranslate nohighlight">
\[p(i) = \frac{\nu_i}{\sum_i \nu_i},\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_i\)</span> are the efficiencies.
Note that the efficiencies do not need to sum to one, and if only a single reaction is specified the efficiency specifier has not real effect.
The above reactions include the null reaction in order to ensure that the correct secondary emission probability is reached, where the <code class="docutils literal notranslate"><span class="pre">(null)</span></code> specifier implies that no secondary emission takes place.
In the above example the probability of secondary electron emission is 0.1, while the probability of a null-reaction (outgoing particle is absorbed without any associated emission) is 0.9.
The above example can be compressed by using a wildcard and an <code class="docutils literal notranslate"><span class="pre">efficiencies</span></code> array as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;dielectric emission&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;reaction&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y -&gt; @&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;@&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(null)&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;efficiencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where for the sake of demonstration the efficiencies are set to 1 and 9 (rather than 0.1 and 0.9).
This has no effect on the probabilities <span class="math notranslate nohighlight">\(p(i)\)</span> given above.</p>
</section>
<section id="field-emission">
<h3>Field emission<a class="headerlink" href="#field-emission" title="Permalink to this heading"></a></h3>
<p>Field emission for a specified species is supported by including a <code class="docutils literal notranslate"><span class="pre">field</span> <span class="pre">emission</span></code> specifier.
Currently supported expressions are:</p>
<ol class="arabic">
<li><p>Fowler-Nordheim emission:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J(E) &amp;= \frac{a F^2}{\phi}\exp\left(-v(f) b \phi^{3/2} F\right),\\
F &amp;= \left(\beta E\right)\times 10^9,\\
a &amp;= 1.541434\times 10^{-6}\,\text{AeV}/\text{V}^2, \\
b &amp;= 6.830890\,\text{eV}^{-3/2}\text{V}\text{nm}^{-1},\\
v(f) &amp;= 1 - f + \left(1/6\right)f\log(f),\\
f &amp;\approx 1.439964\,\text{eV}^2\text{V}^{-1}\text{nm}\times \frac{F}{\phi^2}.\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\phi\)</span> is the work function (in electron volts) and <span class="math notranslate nohighlight">\(\beta\)</span> is an empirical factor that describes local field amplifications.
Note that the above expression gives <span class="math notranslate nohighlight">\(J\)</span> in units of <span class="math notranslate nohighlight">\(\text{A}/\text{nm}^2\)</span>.</p>
</li>
<li><p>Schottky emission:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J(E) &amp;= \lambda A_0 T^2\exp\left(-\frac{\left(\phi-\Delta\phi\right)q_\text{e}}{k_{\text{B}}T}\right), \\
F &amp;= \beta E, \\
A_0 &amp;\approx 1.201736\times 10^6\,\text{A}\text{m}^{-2}\text{K}^{-2}, \\
\Delta \phi &amp;= \sqrt{\frac{q_\text{e} F}{4\pi\epsilon_0}}.\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(T\)</span> is the cathode temperature and <span class="math notranslate nohighlight">\(\phi\)</span> is the work function (in electron volts).
The value <span class="math notranslate nohighlight">\(\lambda\)</span> is typically around <span class="math notranslate nohighlight">\(0.5\)</span>.
As for the Fowler-Nordheim equation, a factor that describes local field amplifications is given in <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The expressions above both use a correction factor <span class="math notranslate nohighlight">\(\beta\)</span> that describes local field amplifications.
Note, however, that the number of emitted electrons is proportional to the area of the emitter, and there are no current models in <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code> that can compute this effective area.</p>
</div>
<p>Below, we show an example that includes both Schottky and Fowler-Nordheim emission</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;field emission&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;surface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electrode&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fowler-nordheim&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;work&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;beta&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;species&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;e&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;surface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;electrode&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;schottky&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lambda&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span>
<span class="w">        </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;work&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;beta&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="warnings-and-caveats">
<span id="chap-itokmcwarnings"></span><h3>Warnings and caveats<a class="headerlink" href="#warnings-and-caveats" title="Permalink to this heading"></a></h3>
<section id="higher-order-reactions">
<h4>Higher-order reactions<a class="headerlink" href="#higher-order-reactions" title="Permalink to this heading"></a></h4>
<p>Usually, many rate coefficients depend on the output of other software (e.g., BOLSIG+) and the scaling of rate coefficients is not immediately obvious.
This is particularly the case for three-body reactions with BOLSIG+ that may require scaling before running the Boltzmann solver (by scaling the input cross sections), or after running the Boltzmann solver, in which case the rate coefficients themselves might require scaling. In any case the user should investigate the cross-section file that BOLSIG+ uses, and figure out the required scaling.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For two-body reactions, e.g. <span class="math notranslate nohighlight">\(A + B\rightarrow \varnothing\)</span> the rate coefficient must be specified in units of <span class="math notranslate nohighlight">\(\textrm{m}^3\textrm{s}^{-1}\)</span>, while for three-body reactions <span class="math notranslate nohighlight">\(A + B + C\rightarrow\varnothing\)</span> the rate coefficient must have units of <span class="math notranslate nohighlight">\(\textrm{m}^6\textrm{s}^{-1}\)</span>.</p>
<p>For three-body reactions the units given by BOLSIG+ in the output file may or may not be incorrect (depending on whether or not the user scaled the cross sections).</p>
</div>
</section>
<section id="id14">
<h4>Townsend coefficients<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h4>
<p>Townsend coefficients are not fundamentally required for specifying the reactions, but as with the higher-order reactions some of the output rates for three-body reactions might be inconsistently represented in the BOLSIG+ output files.
For example, some care might be required when using the Townsend attachment coefficient for air when the reaction <span class="math notranslate nohighlight">\(\textrm{e} + \textrm{O}_2 + \textrm{O}_2\rightarrow \textrm{O}_2^- + \textrm{O}_2\)</span> is included because the rate constant might require proper scaling after running the Boltzmann solver, but this scaling is invisible to the BOLSIG+’s calculation of the attachment coefficient <span class="math notranslate nohighlight">\(\eta/N\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The JSON interface <em>does not guard</em> against inconsitencies in the user-provided chemistry, and provision of inconsistent <span class="math notranslate nohighlight">\(\eta/N\)</span> and attachment reaction rates are quite possible.</p>
</div>
</section>
</section>
<section id="tips-and-tricks">
<h3>Tips and tricks<a class="headerlink" href="#tips-and-tricks" title="Permalink to this heading"></a></h3>
<p>As with fluid drift-diffusion models, numerical instabilities can also occur due to unbounded growth in the plasma density.
This is a process which has been linked both to the local field approximation and also to the presence of numerical diffusion.
Simulations that fail to stabilize, i.e., where the field strength diverges, may benefit from the following stabilizing features:</p>
<ol class="arabic">
<li><p><strong>Turn off parallel diffusion.</strong></p>
<p>With the <code class="docutils literal notranslate"><span class="pre">ItoKMCGodunovStepper</span></code> class, this option is given by <code class="docutils literal notranslate"><span class="pre">ItoKMCGodunovStepper.limit_parallel_diffusion</span></code>.
Using this option will ensure that particles do not diffuse against their drift direction.
Note that this also modifies the amount of <em>physical</em> diffusion in this direction.</p>
</li>
<li><p><strong>Use gradient corrections.</strong></p>
<p>As discussed earlier, using a gradient correction can help limit non-physical ionization due to backwards-diffusing electrons.</p>
</li>
<li><p><strong>Use downstream particle placement.</strong></p>
<p>Because the KMC algorithm solves for the number of particles in a grid cell, distributing new particles uniformly over a grid cell can lead to numerical diffusion where secondary electrons are placed in the wake of primary electrons.
Using downstream particle placement often leads to slightly more stable simulations.</p>
</li>
<li><p><strong>Describe the primary species using an Ito solver.</strong></p>
<p>Similar to the point above, using a fluid solver for the ions may lead to upstream placement of the resulting positive charge.</p>
</li>
<li><p><strong>Use kd-tree particle merging.</strong></p>
<p>Currently particle merging strategies are reinitialization and merging based on bounding volume hierarchies.
If using reinitialization, new particles can be generated in the wake of old ones and can thus upset the charge distribution and cause numerical backwards diffusion (e.g., of electrons).</p>
</li>
<li><p><strong>Numerically limit reaction rates.</strong></p>
<p>It is possible to specify that reaction rates will be numerically limited so that the rate does not exceed a specified threshold of <span class="math notranslate nohighlight">\(\Delta t^{-1}\)</span>.
This is done through the JSON interface by setting <code class="docutils literal notranslate"><span class="pre">limit</span> <span class="pre">max</span> <span class="pre">k*dt</span></code> to some value.
Note that this changes the physics of the model, but usually enhances stability at larger time steps.
An example is given below:</p>
</li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>&quot;plasma reactions&quot;: [
   {
      &quot;reaction&quot;: &quot;e + N2 -&gt; e + e + N2+&quot;
      &quot;type&quot;: &quot;constant&quot;,
      &quot;value&quot;: 1.E-12,
      &quot;limit max k*dt&quot; : 2.0
   }
]

This will limit the rate such that :math:`k \left[\text[N]_2\right]\Delta t = 2`.
I.e., all background species are first absorbed into the rate calculation before the rate is limited.
We point out that limiting is not possible if both species on the left hand side are solver variables.
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The above features have been implemented in order to push the algorithm towards coarser grids and larger time steps.
It is essential that the user checks that the model converges when these features are applied.</p>
</div>
</section>
</section>
<section id="example-programs">
<h2>Example programs<a class="headerlink" href="#example-programs" title="Permalink to this heading"></a></h2>
<p>Example programs that use the Îto-KMC module are given in</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">$DISCHARGE_HOME/Exec/Examples/ItoKMC/AirBasic</span></code> for a basic streamer discharge in atmospheric air.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">$DISCHARGE_HOME/Exec/Examples/ItoKMC/AirDBD</span></code> for a streamer discharge over a dielectric.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DischargeInceptionModel.html" class="btn btn-neutral float-left" title="Discharge inception model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AdvectionDiffusionModel.html" class="btn btn-neutral float-right" title="Advection-diffusion model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SINTEF Energy Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>