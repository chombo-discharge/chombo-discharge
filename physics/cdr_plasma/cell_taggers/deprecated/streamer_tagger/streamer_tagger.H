/*!
  @file   streamer_tagger.H
  @brief  Declaration of a  class for tagging streamer heads
  @author Robert Marskar
  @date   Oct. 2018
*/

#ifndef _STREAMER_TAGGER_H
#define _STREAMER_TAGGER_H

#include "cell_tagger.H"

/*!
  @brief Class that tags streamer heads based on the electron source term. 
  @note  The electrons must be the first class that is defined in the cdr solver layout
*/
class streamer_tagger : public cell_tagger {
public:
  
  streamer_tagger();
  ~streamer_tagger();

  void compute_tracers();
  
protected:

  Real m_fudge;
  int m_electron_idx;
  Vector<Real> m_thresh1;
  Vector<Real> m_thresh2;



  bool coarsen_cell(const RealVect&         a_pos,
		    const Real&             a_time,
		    const Real&             a_dx,
		    const int&              a_lvl,
		    const Vector<Real>&     a_tracer,
		    const Vector<RealVect>& a_grad_tracer);

  bool refine_cell(const RealVect&         a_pos,
		   const Real&             a_time,
		   const Real&             a_dx,
		   const int&              a_lvl,
		   const Vector<Real>&     a_tracer,
		   const Vector<RealVect>& a_grad_tracer);
#include "CD_NamespaceFooter.H"

#endif
