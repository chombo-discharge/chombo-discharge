<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Random numbers &mdash; chombo-discharge  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
      <link rel="stylesheet" type="text/css" href="../_static/my_theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Least squares" href="LeastSquares.html" />
    <link rel="prev" title="LookupTable1D" href="LookupTable.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            chombo-discharge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Base/Documentation.html">Using this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Control.html">Controlling <code class="docutils literal notranslate"><span class="pre">chombo-discharge</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Testing.html">Code testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Base/Acknowledgements.html">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/DesignOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Driver.html">Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ComputationalGeometry.html">ComputationalGeometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/TimeStepper.html">TimeStepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/AmrMesh.html">AmrMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/CellTagger.html">CellTagger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Source/SpatialDiscretization.html">Spatial discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/ChomboBasics.html"><code class="docutils literal notranslate"><span class="pre">Chombo-3</span></code> basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/MeshData.html">Mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/LinearSolvers.html">Linear solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Source/VV.html">Verification and validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Electrostatics.html">Electrostatic solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/Ito.html">Îto diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/KineticMonteCarlo.html">Kinetic Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/MeshODESolver.html">Mesh ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/SurfaceODESolver.html">Surface ODE solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Solvers/TracerParticles.html">Tracer particles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multi-physics applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/CdrPlasmaModel.html">CDR plasma model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/DischargeInceptionModel.html">Discharge inception model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ItoKMC.html">Îto-KMC plasma model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Single-solver applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Applications/AdvectionDiffusionModel.html">Advection-diffusion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/BrownianWalkerModel.html">Brownian walker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/ElectrostaticsModel.html">Electrostatics model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/GeometryModel.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/MeshODEModel.html">Mesh ODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/RadiativeTransferModel.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Applications/TracerParticleModel.html">Tracer particle model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DataParser.html">Data parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="LookupTable.html">LookupTable1D</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Random numbers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#drawing-random-numbers">Drawing random numbers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-approach">General approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-defined-distributions">Pre-defined distributions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#seeding-the-rng">Seeding the RNG</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LeastSquares.html">Least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/Contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contrib/CodeStandard.html">Code standard</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ZZReferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chombo-discharge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Random numbers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Utilities/RandomNumbers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="random-numbers">
<span id="chap-random"></span><h1>Random numbers<a class="headerlink" href="#random-numbers" title="Permalink to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">Random</span></code> is a static class for generating pseudo-random numbers, and exist so that all random number operations can be aggregated into a single class.
Internally, <code class="docutils literal notranslate"><span class="pre">Random</span></code> use a Mersenne-Twister random number generation supplied by <code class="docutils literal notranslate"><span class="pre">std::random</span></code>.</p>
<p>To use the <code class="docutils literal notranslate"><span class="pre">Random</span></code> class, simply include <code class="docutils literal notranslate"><span class="pre">&lt;CD_Random.H&gt;</span></code>, e.g.,</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;CD_Random.H&gt;</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://chombo-discharge.github.io/chombo-discharge/doxygen/html/classRandom.html">Random API</a> for further details.</p>
<section id="drawing-random-numbers">
<h2>Drawing random numbers<a class="headerlink" href="#drawing-random-numbers" title="Permalink to this heading"></a></h2>
<section id="general-approach">
<h3>General approach<a class="headerlink" href="#general-approach" title="Permalink to this heading"></a></h3>
<p>The general routine for drawing a random number is</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/*!</span>
<span class="cm">  @brief For getting a random number from a user-supplied distribution. T must be a distribution for which we can call T(s_rng)</span>
<span class="cm">  @param[in] a_distribution Distribution. Must have object of type</span>
<span class="cm">*/</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Real</span>
<span class="n">get</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">a_distribution</span><span class="p">);</span>
</pre></div>
</div>
<p>Here, the template parameter <code class="docutils literal notranslate"><span class="pre">T</span></code> is some distribution that follows the appropriate C++ template constraints of <code class="docutils literal notranslate"><span class="pre">&lt;random&gt;</span></code>.
For example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">uniform_real_distribution</span><span class="o">&lt;</span><span class="n">Real</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0</span><span class="p">);</span>

<span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">randomNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Random</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="n">dist</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="pre-defined-distributions">
<h3>Pre-defined distributions<a class="headerlink" href="#pre-defined-distributions" title="Permalink to this heading"></a></h3>
<p>Pre-defined distributions exist for performing the following operations:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/*!</span>
<span class="cm">  @brief Get Poisson distributed number</span>
<span class="cm">  @param[in] a_mean Poisson mean value (inverse rate)</span>
<span class="cm">*/</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">enable_if_t</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">is_integral</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;&gt;</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">T</span>
<span class="n">getPoisson</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_mean</span><span class="p">);</span>

<span class="cm">/*!</span>
<span class="cm">  @brief Get Poisson distributed number. </span>
<span class="cm">  @param[in] a_N Number of trials</span>
<span class="cm">  @param[in] a_p The usual success probability in binomial distributions</span>
<span class="cm">*/</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">enable_if_t</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">is_integral</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;&gt;</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">T</span>
<span class="n">getBinomial</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">a_N</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a_p</span><span class="p">)</span><span class="w"> </span><span class="k">noexcept</span><span class="p">;</span>

<span class="cm">/*!</span>
<span class="cm">  @brief Get a uniform real number on the interval [0,1]</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Real</span>
<span class="nf">getUniformReal01</span><span class="p">();</span>

<span class="cm">/*!</span>
<span class="cm">  @brief Get a uniform real number on the interval [-1,1]</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Real</span>
<span class="nf">getUniformReal11</span><span class="p">();</span>

<span class="cm">/*!</span>
<span class="cm">  @brief Get a number from a normal distribution centered on zero and variance 1</span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Real</span>
<span class="nf">getNormal01</span><span class="p">();</span>

<span class="cm">/*!</span>
<span class="cm">  @brief Get a random direction in space.</span>
<span class="cm">  @details Uses Marsaglia algorithm. </span>
<span class="cm">*/</span>
<span class="kr">inline</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">RealVect</span>
<span class="nf">getDirection</span><span class="p">();</span>
</pre></div>
</div>
</section>
</section>
<section id="seeding-the-rng">
<h2>Seeding the RNG<a class="headerlink" href="#seeding-the-rng" title="Permalink to this heading"></a></h2>
<p>By default, the random number generator is seeded using the MPI rank.
It is necessary to seed MPI ranks using different seeds to avoid them producing the same number sequences.
If using MPI+OpenMP, additional steps are taken to ensure that each OpenMP thread obtains a unique random number generator.</p>
<p><code class="docutils literal notranslate"><span class="pre">Driver</span></code> (see <a class="reference internal" href="../Source/Driver.html#chap-driver"><span class="std std-ref">Driver</span></a>) will seed the random number generator, and user can override the seed by setting <code class="docutils literal notranslate"><span class="pre">Random.seed</span> <span class="pre">=</span> <span class="pre">&lt;number&gt;</span></code> in the input script.
If the user sets <code class="docutils literal notranslate"><span class="pre">&lt;number&gt;</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> then a random seed will be produced based on the elapsed CPU clock time.
If running with MPI, this seed is obtained by only one of the MPI ranks, and this seed is then broadcast to all the other ranks.
The other ranks will then increment the seed by their own MPI rank number so that each MPI rank gets a unique seed.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="LookupTable.html" class="btn btn-neutral float-left" title="LookupTable1D" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="LeastSquares.html" class="btn btn-neutral float-right" title="Least squares" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SINTEF Energy Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>